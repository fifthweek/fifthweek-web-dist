function FifthweekError(a){this.message=a,this.stack=Error().stack}function CancellationError(a){this.message=a,this.stack=Error().stack}function ConnectionError(a){this.message=a,this.stack=Error().stack}function AzureError(a,b){this.message=a,this.response=b,this.stack=Error().stack}function DisplayableError(a,b){this.message=a,this.detailedMessage=b,this.stack=Error().stack}function InputValidationError(a){this.message=a,this.stack=Error().stack}function ApiError(a,b){this.message=a,this.response=b,this.stack=Error().stack}function UnauthenticatedError(a){this.message=a,this.stack=Error().stack}function UnauthorizedError(a){this.message=a,this.stack=Error().stack}window.configuredApiBaseUri="https://api.fifthweek.com/";var config={configurable:!0,value:function(){var a={},b=function(b){a[b]=this[b]};return Object.getOwnPropertyNames(this).forEach(b,this),a}};Object.defineProperty(Error.prototype,"toJSON",config),FifthweekError.prototype=Object.create(Error.prototype),FifthweekError.prototype.constructor=FifthweekError,CancellationError.prototype=Object.create(Error.prototype),CancellationError.prototype.constructor=CancellationError,ConnectionError.prototype=Object.create(Error.prototype),ConnectionError.prototype.constructor=ConnectionError,AzureError.prototype=Object.create(Error.prototype),AzureError.prototype.constructor=AzureError,DisplayableError.prototype=Object.create(Error.prototype),DisplayableError.prototype.constructor=DisplayableError,InputValidationError.prototype=Object.create(DisplayableError.prototype),InputValidationError.prototype.constructor=InputValidationError,ApiError.prototype=Object.create(DisplayableError.prototype),ApiError.prototype.constructor=ApiError,UnauthenticatedError.prototype=Object.create(ApiError.prototype),UnauthenticatedError.prototype.constructor=UnauthenticatedError,UnauthorizedError.prototype=Object.create(ApiError.prototype),UnauthorizedError.prototype.constructor=UnauthorizedError,window.onerror=function(a,b,c,d){if(!b||-1===b.indexOf("froogaloop")&&(-1===b.indexOf("vendor")||-1===a.indexOf("contentWindow")&&-1===a.indexOf("postMessage"))){var e=function(a){return a.replace("\\","\\\\").replace('"','\\"')},f=window.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml3.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(b){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(d){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}},g=new f;g.open("POST",window.configuredApiBaseUri+"/log",!0),g.setRequestHeader("Content-type","application/json"),window.developerName&&g.setRequestHeader("Developer-Name",window.developerName),g.send('{ level: "error", payload: { "message": "'+e(a||"")+'","source": "'+e(b||"")+'","url": "'+e(window.location.href)+'","line": "'+(c||0)+'","column": "'+(d||0)+'"}}')}},angular.module("webApp",["ngResource","ngRoute","ui.router","routes","ngSanitize","LocalStorageModule","ng-focus","ui.bootstrap","snap","monospaced.elastic","angulartics","angulartics.google.analytics","angulartics.google.analytics.userid","angulartics.kissmetrics","videosharing-embed"]).constant("fifthweekConstants",{apiBaseUri:window.configuredApiBaseUri,developerName:window.developerName,developerNameHeader:"Developer-Name",clientId:"fifthweek.web.1",unexpectedErrorText:"An error has occurred.",connectionErrorText:"Unable to communicate with the server. Make sure you are connected to the internet and try again.",tokenPath:"token",logPath:"log",longDateFormat:"EEEE, MMMM d, yyyy",longDateTimeFormat:"EEEE, MMMM d 'at' HH:mm 'UTC'",newsfeedDateFormat:"MMM d",dayGroupingDateFormat:"EEEE, MMM d"}).config(["snapRemoteProvider",function(a){a.globalOptions={disable:"right",touchToDrag:!1}}]),angular.module("routes",["ui.router"]).constant("uiRouterConstants",{stateChangeStartEvent:"$stateChangeStart",stateChangeSuccessEvent:"$stateChangeSuccess"}).constant("states",{home:{name:"home"},signIn:{name:"signIn",signIn:{name:"signIn.signIn"},forgot:{name:"signIn.forgot"},reset:{name:"signIn.reset"}},signOut:{name:"signOut"},account:{name:"account"},dashboard:{name:"dashboard",newsFeed:{name:"dashboard.newsFeed"},notifications:{name:"dashboard.notifications"}},creators:{name:"creators",createBlog:{name:"creators.createBlog"},landingPage:{name:"creators.landingPage",preview:{name:"creators.landingPage.preview"},edit:{name:"creators.landingPage.edit"}},posts:{name:"creators.posts",live:{name:"creators.posts.live"},scheduled:{name:"creators.posts.scheduled",list:{name:"creators.posts.scheduled.list"},queues:{name:"creators.posts.scheduled.queues",list:{name:"creators.posts.scheduled.queues.list"},reorder:{name:"creators.posts.scheduled.queues.reorder"}}}},collections:{name:"creators.collections","new":{name:"creators.collections.new"},edit:{name:"creators.collections.edit"},list:{name:"creators.collections.list"}},channels:{name:"creators.channels","new":{name:"creators.channels.new"},edit:{name:"creators.channels.edit"},list:{name:"creators.channels.list"}}},help:{name:"help",faq:{name:"help.faq"},contact:{name:"help.contact"},legal:{name:"help.legal",termsOfService:{name:"help.legal.termsOfService"},privacyPolicy:{name:"help.legal.privacyPolicy"}}},notAuthorized:{name:"notAuthorized"},notFound:{name:"notFound"},comingSoon:{name:"comingSoon"}}).config(["$stateProvider","$urlRouterProvider","$locationProvider","states",function(a,b,c,d){c.html5Mode(!0),b.otherwise("/coming-soon"),a.state(d.home.name,{url:"/",templateUrl:"views/home.html",controller:"HomeCtrl",data:{pageTitle:"Home",navigationHidden:!0,bodyClass:"page-home",access:{requireUnauthenticated:!0}}}).state(d.signIn.name,{url:"/sign-in",templateUrl:"modules/common/ui-view.html",redirectTo:d.signIn.signIn.name,data:{access:{requireUnauthenticated:!0}}}).state(d.signIn.signIn.name,{url:"",templateUrl:"views/sign-in/sign-in.html",controller:"SignInCtrl",data:{pageTitle:"Sign In",headTitle:": Sign In",access:{requireUnauthenticated:!0}}}).state(d.signIn.forgot.name,{url:"/forgot",templateUrl:"views/sign-in/forgot.html",controller:"SignInForgotCtrl",data:{pageTitle:"Forgot Your Details?",headTitle:": Forgot Details?",access:{requireUnauthenticated:!0}}}).state(d.signIn.reset.name,{url:"/reset?userId&token",templateUrl:"views/sign-in/reset.html",controller:"SignInResetCtrl",data:{pageTitle:"Reset Password",headTitle:": Reset Password",access:{requireUnauthenticated:!0}}}).state(d.signOut.name,{url:"/sign-out",templateUrl:"views/signout.html",controller:"SignOutCtrl",data:{pageTitle:"Sign Out",headTitle:": Sign Out",access:{requireAuthenticated:!0}}}).state(d.account.name,{url:"/account",templateUrl:"modules/account/account.html",controller:"AccountCtrl",data:{pageTitle:"My Account",headTitle:": My Account",bodyClass:"page-account-settings",access:{requireAuthenticated:!0}}}).state(d.dashboard.name,{"abstract":!1,url:"/dashboard",templateUrl:"modules/common/ui-view.html",redirectTo:d.dashboard.newsFeed.name,data:{access:{requireAuthenticated:!0}}}).state(d.dashboard.newsFeed.name,{url:"/news-feed",templateUrl:"modules/newsfeed/newsfeed.html",data:{pageTitle:"News Feed",headTitle:": News Feed",access:{requireAuthenticated:!0}}}).state(d.dashboard.notifications.name,{url:"/notifications",templateUrl:"modules/notifications/notifications.html",data:{pageTitle:"Notifications",headTitle:": Notifications",bodyClass:"page-notifications",access:{requireAuthenticated:!0}}}).state(d.creators.name,{"abstract":!1,url:"/creator",templateUrl:"modules/common/ui-view.html",redirectTo:d.creators.posts.name,data:{access:{requireAuthenticated:!0}}}).state(d.creators.createBlog.name,{url:"/create-blog",templateUrl:"modules/creator-blog/create-blog.html",controller:"createBlogCtrl",requireBlog:!1,data:{pageTitle:"About Your Blog",headTitle:": Create Blog",access:{requireAuthenticated:!0}}}).state(d.creators.landingPage.name,{"abstract":!1,url:"/landing-page",templateUrl:"modules/common/ui-view.html",redirectTo:d.creators.landingPage.preview.name,requireBlog:!0,data:{access:{requireAuthenticated:!0}}}).state(d.creators.landingPage.preview.name,{url:"/preview",templateUrl:"modules/creator-timeline/creator-timeline.html",controller:"timelineCtrl",requireBlog:!0,data:{pageTitle:"Landing Page",headTitle:": Landing Page",navigationHidden:!0,bodyClass:"page-timeline",access:{requireAuthenticated:!0}}}).state(d.creators.landingPage.edit.name,{url:"/edit",templateUrl:"modules/creator-blog/customize-landing-page.html",controller:"customizeLandingPageCtrl",requireBlog:!0,data:{pageTitle:"Edit Appearance",headTitle:": Edit Appearance",bodyClass:"page-blog-landing"}}).state(d.creators.posts.name,{"abstract":!1,url:"/posts",templateUrl:"modules/common/ui-view.html",requireBlog:!0,redirectTo:d.creators.posts.live.name,data:{access:{requireAuthenticated:!0}}}).state(d.creators.posts.live.name,{url:"/live",templateUrl:"modules/creator-posts/creator-posts.html",controller:"timelineCtrl",requireBlog:!0,data:{pageTitle:"Live Posts",headTitle:": Live Posts",access:{requireAuthenticated:!0}}}).state(d.creators.posts.scheduled.name,{url:"/scheduled",templateUrl:"modules/common/ui-view.html",redirectTo:d.creators.posts.scheduled.list.name,requireBlog:!0,data:{access:{requireAuthenticated:!0}}}).state(d.creators.posts.scheduled.list.name,{url:"",templateUrl:"modules/creator-backlog/backlog-post-list.html",controller:"backlogPostListCtrl",requireBlog:!0,data:{pageTitle:"Scheduled Posts",headTitle:": Scheduled Posts",bodyClass:"page-creators-backlog-post-list",access:{requireAuthenticated:!0}}}).state(d.creators.posts.scheduled.queues.name,{url:"/queues",templateUrl:"modules/common/ui-view.html",redirectTo:d.creators.posts.scheduled.queues.list.name,requireBlog:!0,data:{access:{requireAuthenticated:!0}}}).state(d.creators.posts.scheduled.queues.list.name,{url:"/",templateUrl:"modules/creator-backlog/backlog-queue-list.html",requireBlog:!0,data:{pageTitle:"Queues",headTitle:": Queues",access:{requireAuthenticated:!0}}}).state(d.creators.posts.scheduled.queues.reorder.name,{url:"/{id}",templateUrl:"modules/creator-backlog/backlog-queue-reorder.html",controller:"queueReorderCtrl",requireBlog:!0,data:{pageTitle:"Reorder Queue",headTitle:": Reorder Queues",access:{requireAuthenticated:!0}}}).state(d.creators.collections.name,{url:"/collections",templateUrl:"modules/common/ui-view.html",requireBlog:!0,redirectTo:d.creators.collections.list.name,data:{access:{requireAuthenticated:!0}}}).state(d.creators.collections["new"].name,{url:"/new",templateUrl:"modules/collections/new-collection.html",controller:"newCollectionCtrl",requireBlog:!0,data:{headTitle:": Create Collection",access:{requireAuthenticated:!0}}}).state(d.creators.collections.edit.name,{url:"/{id}",templateUrl:"modules/collections/edit-collection.html",controller:"editCollectionCtrl",requireBlog:!0,data:{headTitle:": Edit Collection",access:{requireAuthenticated:!0}}}).state(d.creators.collections.list.name,{url:"",templateUrl:"modules/collections/list-collections.html",controller:"listCollectionsCtrl",requireBlog:!0,data:{pageTitle:"Collections",headTitle:": Collections",access:{requireAuthenticated:!0}}}).state(d.creators.channels.name,{url:"/channels",templateUrl:"modules/common/ui-view.html",requireBlog:!0,redirectTo:d.creators.channels.list.name,data:{access:{requireAuthenticated:!0}}}).state(d.creators.channels["new"].name,{url:"/new",templateUrl:"modules/channels/new-channel.html",controller:"newChannelCtrl",requireBlog:!0,data:{headTitle:": Create Channel",access:{requireAuthenticated:!0}}}).state(d.creators.channels.edit.name,{url:"/{id}",templateUrl:"modules/channels/edit-channel.html",controller:"editChannelCtrl",requireBlog:!0,data:{headTitle:": Edit Channel",access:{requireAuthenticated:!0}}}).state(d.creators.channels.list.name,{url:"",templateUrl:"modules/channels/list-channels.html",controller:"listChannelsCtrl",requireBlog:!0,data:{pageTitle:"Blogs",headTitle:": Blogs",access:{requireAuthenticated:!0}}}).state(d.help.name,{"abstract":!1,url:"/help",templateUrl:"modules/common/ui-view.html",redirectTo:d.help.faq.name,data:{pageTitle:"Help",headTitle:": Help",bodyClass:"page-help"}}).state(d.help.faq.name,{url:"/faq",templateUrl:"views/help/faq.html",data:{pageTitle:"Frequently Asked Questions",headTitle:": FAQ"}}).state(d.help.contact.name,{url:"/contact",templateUrl:"views/help/contact-us.html",data:{pageTitle:"Contact Us",headTitle:": Contact Us"}}).state(d.help.legal.name,{"abstract":!1,url:"/legal",templateUrl:"views/help/legal/index.html",redirectTo:d.help.legal.termsOfService.name,data:{pageTitle:"Legal",headTitle:": Legal"}}).state(d.help.legal.termsOfService.name,{url:"/terms-of-service",templateUrl:"views/help/legal/terms-of-service.html",data:{pageTitle:"Terms of Service",headTitle:": Terms of Service"}}).state(d.help.legal.privacyPolicy.name,{url:"/privacy-policy",templateUrl:"views/help/legal/privacy-policy.html",data:{pageTitle:"Privacy Policy",headTitle:": Privacy Policy"}}).state(d.notAuthorized.name,{url:"/not-authorized",templateUrl:"views/not-authorized.html",data:{pageTitle:"Not Authorized",headTitle:": Not Authorized"}}).state(d.notFound.name,{url:"/not-found",templateUrl:"views/not-found.html",data:{pageTitle:"Not Found",headTitle:": Not Found"}}).state(d.comingSoon.name,{url:"/coming-soon",templateUrl:"views/coming-soon.html",data:{pageTitle:"Coming Soon",headTitle:": Coming Soon"}})}]),angular.module("webApp").factory("navigationMap",["aggregateUserStateUtilities","states",function(a,b){"use strict";return[{name:"Register",state:b.home.name,icon:"fa fa-ticket",color:"pink"},{name:"Sign In",state:b.signIn.name,icon:"fa fa-sign-in",color:"green"},{name:"Home",state:b.dashboard.name,icon:"fa fa-home",color:"pink",secondary:[{name:"News Feed",state:b.dashboard.newsFeed.name,icon:"fa fa-align-left",color:"orange"},{name:"Notifications",state:b.dashboard.notifications.name,icon:"fa fa-bell-o",color:"orange"}]},{name:"Landing Page",state:b.creators.landingPage.name,icon:"fa fa-bookmark-o",color:"pink",secondary:[{name:"Preview",state:b.creators.landingPage.preview.name,icon:"fa fa-eye",color:"pink"},{name:"Edit Page",state:b.creators.landingPage.edit.name,icon:"fa fa-pencil",color:"pink"}]},{separator:!0},{name:"Posts",state:b.creators.posts.name,icon:"fa fa-file-text-o",color:"orange",secondary:[{name:"Live Now",state:b.creators.posts.live.name,icon:"fa fa-file-text-o",color:"pink"},{name:"Scheduled",state:b.creators.posts.scheduled.list.name,icon:"fa fa-clock-o",color:"yellow"}]},{name:"Create Blog",state:b.creators.createBlog.name,icon:"fa fa-asterisk",color:"yellow"},{name:"Collections",state:b.creators.collections.name,icon:"fa fa-th",color:"green",secondary:[{name:"Collections",state:b.creators.collections.name,icon:"fa fa-th",color:"green"}]},{name:"Channels",state:b.creators.channels.name,icon:"fa fa-check-square-o",color:"green",secondary:[{name:"Channels",state:b.creators.channels.name,icon:"fa fa-check-square-o",color:"green"}]},{separator:!0},{id:"account",name:a.getUsername,state:b.account.name,icon:"fa fa-user",color:"blue",secondary:[{name:"Account Settings",state:b.account.name,icon:"fa fa-user",color:"blue"},{name:"Sign Out",state:b.signOut.name,icon:"fa fa-sign-out",color:"blue"}]},{name:"Help",state:b.help.faq.name,icon:"fa fa-question-circle",color:"indigo",secondary:[{name:"FAQ",state:b.help.faq.name,icon:"fa fa-book",color:"indigo"},{name:"Contact Us",state:b.help.contact.name,icon:"fa fa-comment-o",color:"indigo"},{name:"Legal",state:b.help.legal.name,icon:"fa fa-files-o",color:"indigo"}]}]}]),function(a){"use strict";a.module("webApp").config(["$httpProvider",function(a){a.interceptors.push("authenticationInterceptor"),a.interceptors.push("developerRequestInterceptor")}]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","logService",function(a,b){return function(c,d){a(c,d),b.logUnhandledError(c,d)}}])}]).run(function(){marked.setOptions({breaks:!0,sanitize:!0})}).run(["$state","states",function(a,b){var c=a.get(),d=a.get(b.home.name),e=c[0];if(""!==e.name)throw new FifthweekError("Failed to find empty state.");e.data={navigationHidden:d.data.navigationHidden,bodyClass:"page-empty"}}]).run(["$rootScope","uiRouterConstants","stateChangeService",function(a,b,c){a.$on(b.stateChangeStartEvent,function(a,b,d){c.redirectAwayIfRequired(a,b,d)})}]).run(["$state","stateChangeService","authenticationService","fetchAggregateUserState","logService",function(a,b,c,d,e){d.updateFromServer(c.currentUser.userId).then(function(){b.isPermitted(a.current)?a.current.name:b.redirectAwayIfRequired({preventDefault:function(){}},a.current,a.params)})["catch"](function(a){e.error(a)})}]).run(["$rootScope","$state","$stateParams","fifthweekConstants",function(a,b,c,d){a.fifthweekConstants=d,a.$state=b,a.$stateParams=c}])}(angular),angular.module("webApp").run(["$templateCache",function(a){"use strict";a.put("modules/account/account.html",'<form novalidate id=accountSettingsForm role=form name=form> <fw-panel12> <fw-error-message value=model.errorMessage></fw-error-message> <div ng-if=model.isLoading> <p> <i class="fa fa-refresh fa-spin"></i> </p> </div> <div ng-show=model.accountSettings> <div class="form-group form-group-has-buffers"> <label>Profile Image</label> <div class=row> <div class="col-xs-8 col-s-5 col-md-4"> <fw-blob-image control=blobImage thumbnail=preview></fw-blob-image> </div> <div class="col-xs-4 col-s-7 col-md-5"> <fw-file-upload description=Upload on-upload-complete=onUploadComplete(data) file-purpose=profile-image accept=image/jpeg></fw-file-upload> </div> <div class="col-xs-12 bottom-buffer"> <small class=sub-image-input>We recommend images at least 600x600 pixels.</small> </div> </div> </div> <fw-form-group> <label for=email>Email</label> <div class=row> <div class=col-md-6> <div fw-form-input-glyphs> <input type=email id=email class=form-control name=email placeholder=Email ng-model=model.accountSettings.email required> </div> </div> <div class=col-md-6> <p fw-form-input-invalid-p>A valid email address is required.</p> </div> </div> </fw-form-group> <fw-form-input-username ng-model=model.accountSettings.username label=Username breakpoint=md required></fw-form-input-username> <fw-form-input-password ng-model=model.password placeholder="New password" label=Password breakpoint=md></fw-form-input-password> <div class=row-btn> <div ng-show="form.submissionSucceeded && form.$pristine" class="alert alert-success"> <p>Saved successfully</p> </div> <fw-error-message value=form.message></fw-error-message> <button type=submit id=save-changes-button class="btn btn-block btn-success" data-loading-text=Saving... data-event-title="Account settings saved" data-event-category=Account ng-disabled="form.$pristine || form.isSubmitting" fw-form-submit=submitForm()> Save Changes </button> <fw-form-cancel-button ng-disabled="form.$pristine || form.isSubmitting" id=cancel-button></fw-form-cancel-button> <fw-form-dirty-confirmation form=form></fw-form-dirty-confirmation> </div> </div> </fw-panel12> </form>'),a.put("modules/blog/directives/form-input-blog-name.html","<fw-form-group input-name=blogName> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=blogName class=form-control placeholder={{placeholder}} ng-maxlength=25 maxlength=25 focus={{focus}} ng-required=required> </div> <small ng-if=showHelp>e.g. your name</small> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=maxlength>Allowed 25 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A name is required.</p> </span> </div> </div> </fw-form-group>"),a.put("modules/blog/directives/form-input-tagline.html","<fw-form-group input-name=tagline> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=tagline class=form-control placeholder={{placeholder}} ng-minlength=5 ng-maxlength=55 maxlength=55 focus={{focus}} ng-required=required> </div> <small ng-if=showHelp>e.g. &#34;Web Comics And More&#34;</small> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=minlength>Must be at least 5 characters.</p> <p fw-form-input-invalid-p=maxlength>Allowed 55 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A tagline is required.</p> </span> </div> </div> </fw-form-group>"),a.put("modules/channels/directives/form-input-channel-description.html",'<fw-form-group input-name=channelDescription> <div class=row> <div class=col-xs-12> <textarea id={{inputId}} name=channelDescription ng-model=ngModel[ngModelAccessor] class=form-control placeholder="What will the subscriber receive?\nMultiple points can be entered over new lines." ng-maxlength=250 maxlength=250 focus={{focus}} ng-required=required msd-elastic></textarea> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=maxlength>Allowed 250 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A description is required.</p> </span> </div> </div> </fw-form-group>'),a.put("modules/channels/directives/form-input-channel-name.html","<fw-form-group input-name=channelName> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=channelName class=form-control placeholder={{placeholder}} ng-maxlength=50 maxlength=50 focus={{focus}} ng-required=required> </div> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=maxlength>Allowed 50 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A name is required.</p> </span> </div> </div> </fw-form-group>"),a.put("modules/channels/directives/form-input-channel-price.html",'<fw-form-group input-name=channelPrice> <div class=row> <div class=col-{{breakpoint}}-6> <div class=input-group> <div class=input-group-addon>&#36;</div> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=channelPrice class=form-control money min=0.01 focus={{focus}} ng-required=required> <div class=input-group-addon>per week</div> </div> <small ng-if=showHelp>i.e. the amount people will pay you</small>  <span style="right: 98px" fw-form-input-valid class="glyphicon glyphicon-ok form-control-feedback" aria-hidden=true></span> <span style="right: 98px" fw-form-input-invalid class="glyphicon glyphicon-remove form-control-feedback" aria-hidden=true></span> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=min>Must be at least one cent.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A price is required.</p> </span> </div> </div> </fw-form-group>'),a.put("modules/channels/directives/form-input-channel-visibility.html","<fw-form-group input-name=channelHidden> <div class=row> <div class=col-xs-12> <div class=checkbox> <label> <input id={{inputId}} name=channelHidden ng-model=ngModel[ngModelAccessor] type=checkbox> Hidden channel </label> <small>Hidden channels are not listed on your landing page.</small> </div> </div> </div> </fw-form-group>"),a.put("modules/channels/edit-channel.html",'<div> <fw-breadcrumb current={{model.savedChannelName}}></fw-breadcrumb> <fw-panel12> <form novalidate id=editChannelForm role=form name=form> <label>Name</label> <fw-form-input-channel-name ng-model=model.channel.name placeholder="Channel name" required focus></fw-form-input-channel-name> <label>Description</label> <fw-form-input-channel-description ng-model=model.channel.description required></fw-form-input-channel-description> <label>Blog price</label> <fw-form-input-channel-price ng-model=model.channel.price required></fw-form-input-channel-price> <fw-form-input-channel-visibility ng-if=!model.channel.isDefault ng-model=model.channel.hidden required></fw-form-input-channel-visibility> <div class=row-btn> <div class=row> <div class=col-s-8> <button id=save-channel-button class="btn btn-block btn-success" data-loading-text=Saving... data-event-title="Channel edited" data-event-category=Customization ng-disabled="form.$pristine || form.isSubmitting" fw-form-submit=save()>Save Changes</button> <button id=cancel-button class="btn btn-default btn-block" ui-sref={{previousState}} ng-click=form.discard()>Cancel</button> </div> <div class=col-s-4 ng-if=!model.channel.isDefault> <fw-form-input-delete item=model.savedChannelName item-type=Channel link-id=delete-channel-link data-event-title="Channel deleted" data-event-category=Customization delete="form.discard(); delete();"></fw-form-input-delete> </div> </div> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert"> <p>{{form.message}}</p> </div> <fw-form-dirty-confirmation form=form></fw-form-dirty-confirmation> </form> </fw-panel12> </div>'),a.put("modules/channels/list-channels.html",'<div class=page-blog-channels> <fw-managed-list id=channels ng-if=!model.errorMessage item-name=channel items=model.channels new-item-state=creators.channels.new manage-item-state=creators.channels.edit> <h5><a class=channel-name href>{{item.name}}</a> <span ng-if=item.isDefault class=tail>Everyone</span></h5> <ul class=channel-description> <li ng-repeat="description in item.description">{{description}}</li> </ul> </fw-managed-list> <div ng-if=model.errorMessage class="alert alert-danger sub-form-alert"> <p>{{model.errorMessage}}</p> </div> </div>'),a.put("modules/channels/new-channel.html",'<fw-breadcrumb current="New Channel"></fw-breadcrumb> <fw-panel12> <form novalidate role=form id=createChannelForm name=form> <fw-form-input-channel-name ng-model=model.channel.name placeholder="New channel name" required focus></fw-form-input-channel-name> <fw-form-input-channel-description ng-model=model.channel.description required></fw-form-input-channel-description> <fw-form-input-channel-price ng-model=model.channel.price required></fw-form-input-channel-price> <fw-form-input-channel-visibility ng-model=model.channel.hidden required></fw-form-input-channel-visibility> <div class=row-btn> <button id=create-channel-button class="btn btn-block btn-success" data-loading-text=Creating... data-event-title="Channel created" data-event-category=Customization fw-form-submit=create()>Create Channel</button> <button id=cancel-button class="btn btn-default btn-block" ui-sref={{previousState}}>Cancel</button> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert"> <p>{{form.message}}</p> </div> </form> </fw-panel12>'),a.put("modules/collections/directives/form-input-collection-name.html","<fw-form-group input-name=collectionName> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=collectionName class=form-control placeholder={{placeholder}} ng-maxlength=50 maxlength=50 focus={{focus}} ng-required=required> </div> <small ng-if=showHelp>(like an album, except not just for photos)</small> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=maxlength>Allowed 50 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A name is required.</p> </span> </div> </div> </fw-form-group>"),a.put("modules/collections/directives/form-input-select-collection.html",'<div class="form-group form-input-select-collection"> <div class=row> <div class="col-xs-12 col-s-7 col-sm-6"> <div class=select> <select id={{id}} class=select-full-width ng-model=selectedItem ng-options="item.name for item in items"></select> </div> </div> <div class="col-xs-12 col-s-5 col-sm-6"> <button class="btn btn-link create-collection-link" ng-disabled=createNewCollectionDisabled ng-click=createNewCollection()>Create New Collection</button> </div> </div> </div>'),a.put("modules/collections/edit-collection.html",'<div class=page-blog-collections-manage> <form novalidate id=manageCollectionForm name=manageCollectionForm role=form ng-show="!model.addingReleaseTime && !model.selectedReleaseTime"> <fw-breadcrumb current={{model.savedName}}></fw-breadcrumb> <fw-panel12> <label>Name</label> <fw-form-input-collection-name ng-model=model.name placeholder="Collection name" required focus></fw-form-input-collection-name> <label>Available in</label> <fw-form-input-select input-id=model-selected-channel selected-item=model.selectedChannel items=model.channels></fw-form-input-select> <div class=form-group id=manageReleaseTimes> <fw-form-subsection name="Weekly release schedule"> <summary> <p class=release-times> <span class=release-time ng-repeat="time in model.schedule">{{time.day}}</span> </p> </summary> <summary-expanded> <p> When you add posts to ‘the queue’ they automatically become published according to the weekly schedule that is associated with the collection you are posting to. You can define that here: </p> </summary-expanded> <section> <fw-managed-list-sm id=release-time-list item-name="release time" items=model.schedule new-item=addReleaseTime() manage-item=manageReleaseTime(item)> <p>{{item.day}} <span class=release-time-of-day>@ {{item.time}} UTC</span></p> </fw-managed-list-sm> </section> </fw-form-subsection> </div> <div class=row-btn> <div class=row> <div class=col-s-8> <button id=save-collection-button class="btn btn-block btn-success" data-loading-text=Saving... data-event-title="Collection edited" data-event-category=Customization ng-disabled="!mainFormDirty() || manageCollectionForm.isSubmitting" can-submit="manageCollectionForm.$valid && mainFormDirty()" fw-form-submit=save()>Save Changes</button> <button id=cancel-button class="btn btn-default btn-block" ui-sref={{previousState}} ng-click=manageCollectionForm.discard()>Cancel</button> </div> <div class=col-s-4> <fw-form-input-delete item=model.savedName item-type=Collection link-id=delete-collection-link data-event-title="Collection deleted" data-event-category=Customization delete="manageCollectionForm.discard(); delete()"></fw-form-input-delete> </div> </div> </div> <div ng-show=manageCollectionForm.message class="alert alert-danger sub-form-alert"> <p>{{manageCollectionForm.message}}</p> </div> </fw-panel12> <fw-form-dirty-confirmation form=manageCollectionForm form-dirty=mainFormDirty></fw-form-dirty-confirmation> </form>  <form novalidate role=form name=newReleaseTimeForm ng-if=model.addingReleaseTime> <fw-breadcrumb current="New Release Time" previous={{model.savedName}} previous-state="model.addingReleaseTime = false"></fw-breadcrumb> <fw-panel12> <fw-form-input-hour-of-week ng-model=model.hourOfWeek></fw-form-input-hour-of-week> <button id=add-release-time-button class="btn btn-block btn-success" ng-click=saveNewReleaseTime()>Add Release Time</button> <button id=cancel-release-time-button class="btn btn-default btn-block" ng-click="model.addingReleaseTime = false">Cancel</button> </fw-panel12> </form>  <form novalidate role=form name=manageReleaseTimeForm ng-if=model.selectedReleaseTime> <fw-breadcrumb current="Edit Release Time" previous={{model.savedName}} previous-state="model.selectedReleaseTime = null"></fw-breadcrumb> <fw-panel12> <fw-form-input-hour-of-week ng-model=model.hourOfWeek></fw-form-input-hour-of-week> <div class=row> <div class=col-s-8> <button id=save-release-time-button class="btn btn-block btn-success" ng-disabled="manageReleaseTimeForm.$pristine || manageReleaseTimeForm.isSubmitting" ng-click=saveReleaseTime()>Update Release Time</button> <button id=cancel-release-time-button class="btn btn-default btn-block" ng-click="model.selectedReleaseTime = null">Cancel</button> </div> <div class=col-s-4> <fw-form-input-delete ng-if="model.schedule.length > 1" item-type="Release Time" link-id=delete-release-time-link delete=deleteReleaseTime()></fw-form-input-delete> </div> </div> </fw-panel12> </form> </div>'),a.put("modules/collections/list-collections.html",'<fw-managed-list id=collections ng-if=!model.errorMessage item-name=collection items=model.collections new-item-state=creators.collections.new manage-item-state=creators.collections.edit> <h5> <a class=collection-name href>{{item.name}}</a> <span class="channel-name tail">{{item.isDefaultChannel ? \'Everyone\' : item.channel}}</span> </h5> <p class=release-times> <span ng-repeat="time in item.schedule | orderBy:\'sortKey\'">{{time.day}}</span> </p> </fw-managed-list> <div ng-if=model.errorMessage class="alert alert-danger sub-form-alert"> <p>{{model.errorMessage}}</p> </div>'),
a.put("modules/collections/new-collection.html",'<fw-breadcrumb current="New Collection"></fw-breadcrumb> <fw-panel12> <form novalidate role=form id=createCollectionForm name=form> <fw-form-input-collection-name ng-model=model.collection.name placeholder="New collection name" required focus></fw-form-input-collection-name> <fw-form-input-select input-id=model-selected-channel selected-item=model.selectedChannel items=model.channels></fw-form-input-select> <div class=row-btn> <button id=create-collection-button class="btn btn-block btn-success" data-loading-text=Creating... data-event-title="Collection created" data-event-category=Customization fw-form-submit=createCollection()>Create Collection</button> <button id=cancel-button class="btn btn-default btn-block" ui-sref={{previousState}}>Cancel</button> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert"> <p>{{form.message}}</p> </div> </form> </fw-panel12>'),a.put("modules/common/fw-date-time-picker.html",'<div class=row> <div class="col-xs-12 col-ss-8 col-sm-6"> <div class=input-group> <input class=form-control datepicker-popup={{format}} ng-model=date is-open=opened datepicker-options=dateOptions ng-click=openDatePicker($event) close-text=Close readonly> <span class=input-group-btn> <button type=button class="btn btn-default" ng-click=openDatePicker($event)> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="col-xs-12 col-ss-4 col-sm-6"> <div class=timepicker> <timepicker ng-model=time minute-step=15 show-meridian=false></timepicker> </div> </div> </div>'),a.put("modules/common/fw-form-cancel-button.html",'<button class="btn btn-default btn-block" ng-click=cancelForm()>Cancel</button>'),a.put("modules/common/fw-form-dirty-confirmation.html",'<form novalidate role=form name=form> <fw-form-modal name="Discard changes?"> <form-body> <div class=form-group> <p class=bottom-buffer> You have unsaved changes, do you want to continue? </p> </div> </form-body> <form-buttons> <button id=discard-button class="btn btn-block btn-danger" ng-click=$close(true)>Yes, discard changes</button> </form-buttons> </fw-form-modal> </form>'),a.put("modules/common/fw-form-input-date-time-picker.html",'<div class="fw-date-time-picker form-group-no-bottom-margin">  <fw-form-group input-name=dateTimePicker> <div class=row> <div class=col-xs-12> <fw-date-time-picker name=dateTimePicker ng-model=ngModel[ngModelAccessor]></fw-date-time-picker> </div> <div class=col-xs-12> <p fw-form-input-invalid-p>Please select a valid date and time.</p> </div> </div> </fw-form-group> </div>'),a.put("modules/common/fw-form-input-hour-of-week.html",'<div class=hour-of-week> <div class=form-group> <label>Weekly release time</label> <div class=row> <div class="col-xs-6 col-sm-4 day-of-week"> <div class=select> <select id=day-of-week class=select-full-width ng-model=model.day ng-options="item.name for item in model.days"></select> </div> </div> <div class="col-xs-4 col-ss-3 hour-of-day"> <div class=select> <select id=hour-of-day class=select-full-width ng-model=model.hour ng-options="item.name for item in model.hours"></select> </div> </div> <div class="col-xs-2 timezone"> <p>UTC</p> </div> </div> </div> </div>'),a.put("modules/common/fw-image.html",'<div class=image-container> <div class=vertical-aspect-ratio></div> <img id={{id}} class=image-area ng-src="{{src}}"> </div>'),a.put("modules/common/ui-view.html","<div ui-view></div>"),a.put("modules/creator-backlog/backlog-post-list.html","<fw-compose-options></fw-compose-options> <fw-post-list source=creator-backlog></fw-post-list>"),a.put("modules/creator-backlog/backlog-queue-list.html","<div ng-include=\"'../creator-compose/directives/compose-options.html'\"></div> <fw-panel12> <h4>Coming soon...</h4> <p>The ability to reorder queued posts is coming very soon.</p> </fw-panel12> <div class=managed-list ng-if=false ng-init=\"collections = [\n  {id:'a', name:'Blog', postCount:6, postCountText:'6 Posts', schedule:['Monday', 'Wednesday', 'Friday']},\n  {id:'c', name:'Wallpapers', postCount:1, postCountText:'1 Post', schedule:['Tuesday', 'Thursday']},\n  {id:'b', name:'Side Comic', postCount:0, postCountText:'No Posts', schedule:['Sunday']}\n"+']"> <fw-panel12> <div class=row-selection ng-repeat="item in collections" ui-sref="creators.posts.scheduled.queues.reorder({id: item.id})" ng-class="{\'row-selection-disabled\': item.postCount === 0}"> <div class=row> <div class=col-xs-9> <h5 ng-if="item.postCount > 0"> <a href>{{item.name}}</a> </h5> <h5 ng-if="item.postCount === 0">{{item.name}}</h5> <p class=release-times> <span ng-repeat="weekday in item.schedule">{{weekday}}</span> </p> </div> <div class=col-xs-3> <button class="btn btn-default btn-slim" ng-disabled="item.postCount === 0"> <span class=visible-over-s>{{item.postCountText}}</span> <span class=visible-under-sm>{{item.postCount}}</span> <i class="fa fa-chevron-right btn-icon-right"></i> </button> </div> </div> </div> </fw-panel12> </div>'),a.put("modules/creator-backlog/backlog-queue-reorder.html",'<fw-panel12> <h4>Coming soon...</h4> <p>The ability to reorder queued posts is coming very soon.</p> </fw-panel12> <div ng-if=false> <fw-breadcrumb current={{model.collectionName}}></fw-breadcrumb> <div class="posts posts-with-margin tagged-posts queue">  <div class=post ng-repeat="post in posts"> <div ng-class="{\'non-image-post\': !post.imagePath, \'image-post\': post.imagePath, \'file-post\': post.filePath}"> <img ng-if=post.imagePath ng-src={{post.imagePath}} ng-click="viewImage(post)"> <p class=tag>{{post.dayOfWeek}} {{post.date}}</p> <div class=text> <div class=content ng-if="post.comment || post.filePath"> <fw-markdown replace=true ng-model=post.comment ng-if=post.comment></fw-markdown> <p ng-if=post.filePath class=content-file> <a class="btn-file-download file-content" href={{post.filePath}} target=_blank> {{post.fileName}} </a> </p> </div> <div class="col-xs-4 actions"> <ul> <li class=actions-more> <span class=dropdown dropdown on-toggle=toggled(open)> <button class=dropdown-toggle dropdown-toggle> <i class="fa fa-ellipsis-h"></i> </button> <ul class=dropdown-menu> <li><a ng-click=editPost(post)>Edit</a></li> <li> <fw-delete-link item-type=Post event-title="Post deleted" event-category={{sourceName}} delete=deletePost(post.postId)> Delete </fw-delete-link> </li> </ul> </span> </li> </ul> </div> </div> </div> </div> </div> </div>'),a.put("modules/creator-blog/create-blog.html",'<fw-panel12> <form novalidate role=form name=form id=createBlogForm> <fw-form-input-blog-name ng-model=newBlogData.blogName placeholder="Blog title" required focus show-help></fw-form-input-blog-name> <fw-form-input-tagline ng-model=newBlogData.tagline placeholder=Tagline required show-help></fw-form-input-tagline> <fw-form-input-channel-price ng-model=newBlogData.basePrice required show-help></fw-form-input-channel-price> <div class=row-btn> <button id=create-blog-button class="btn btn-block btn-success" data-loading-text=Saving... data-event-title="Blog created" data-event-category=Registration fw-form-submit=continue()>Save and Continue</button> </div> <div class=row> <div class=col-sm-6> <div ng-show=form.message class="alert alert-danger sub-form-alert" id=sign-in-message> <p>{{form.message}}</p> </div> </div> </div> </form> </fw-panel12>'),a.put("modules/creator-blog/customize-landing-page-basics.html",'<div class="panel panel-default"> <div class="panel-body jumbo-panel"> <div ng-include="\'modules/creator-blog/customize-landing-page-loading-area.html\'"></div> <div ng-show=model.settings> <div class=form-group id=vanity-url> <div class=row> <div class=col-xs-12> <h5>URL</h5> <p><a ui-sref=creators.landingPage>{{model.landingPageUrl}}</a></p> </div> </div> </div> <label>Title</label> <fw-form-input-blog-name ng-model=model.settings.blogName placeholder="e.g. Your name or product" required focus></fw-form-input-blog-name> <label>Tagline</label> <fw-form-input-tagline ng-model=model.settings.tagline placeholder="A snappy summary" required></fw-form-input-tagline> <fw-form-group> <label for=introduction>Quick introduction</label> <div class=row> <div class=col-xs-12> <textarea msd-elastic id=introduction class=form-control name=introduction ng-model=model.settings.introduction ng-minlength=15 ng-maxlength=250 maxlength=250 rows=4 placeholder="For example, who are you? And why are you here?" required></textarea> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=minlength>Must be at least 15 characters.</p> <p fw-form-input-invalid-p=maxlength>Allowed 250 characters at most.</p> <p fw-form-input-invalid-p=required>An introduction is required.</p> </div> </div> </fw-form-group> <div ng-include="\'modules/creator-blog/customize-landing-page-submission-area.html\'"></div> </div> </div> </div>'),a.put("modules/creator-blog/customize-landing-page-full-description.html",'<div class="panel panel-default full-description"> <div class="panel-body jumbo-panel"> <div ng-include="\'modules/creator-blog/customize-landing-page-loading-area.html\'"></div> <div ng-show=model.settings> <fw-form-group> <label for=video>Your Video</label> <div class=row> <div class=col-sm-10> <input type=url id=video name=video class=form-control ng-model=model.settings.video ng-maxlength=100 maxlength=100 ng-pattern="/^https?:\\/\\/(www\\.)?((youtube\\.com)|(youtu\\.be)|(vimeo\\.com))\\/.*$/" placeholder="http://"> <p class=light-grey> <small>Creators with videos have a much higher success rate. <br> <strong>Paste in the url of your video from Youtube, Vimeo, etc.</strong></small> </p> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=pattern>YouTube and Vimeo videos only. Must start with \'http://\' or \'https://\'.</p> <p fw-form-input-invalid-p=maxlength>Allowed 100 characters at most.</p> </div> </div> </fw-form-group> <fw-form-group> <label for=description>About the blog</label> <div class=row> <div class=col-xs-12> <textarea msd-elastic id=description name=description class=form-control ng-model=model.settings.description ng-maxlength=2000 maxlength=2000 placeholder="This is where you can really sell your blog... tell everyone why they need to subscribe."></textarea> <p class=light-grey><small>Syntax: <strong>&#42;&#42;bold&#42;&#42;</strong> &#124; <i>&#42;italic&#42;</i> &#124; ![alt text](image_url)</small></p> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=maxlength>Allowed 2000 characters at most.</p> </div> </div> </fw-form-group> <div ng-include="\'modules/creator-blog/customize-landing-page-submission-area.html\'"></div> </div> </div> </div>'),a.put("modules/creator-blog/customize-landing-page-header-image.html",'<div class="panel panel-default header-image"> <div class="panel-body jumbo-panel"> <div ng-include="\'modules/creator-blog/customize-landing-page-loading-area.html\'"></div> <div ng-show=model.settings> <div class="form-group form-group-has-buffers"> <label>Header Image</label> <div class=row> <div class="col-xs-12 col-s-9 col-sm-10 bottom-buffer"> <fw-blob-image control=blobImage thumbnail=preview></fw-blob-image> <small class=sub-image-input>We recommend images at least 3000x1000 pixels.</small> </div> <div class="col-xs-12 col-s-3 col-sm-2 bottom-buffer"> <fw-file-upload description=Upload abbreviate-progress=true on-upload-complete=onUploadComplete(data) file-purpose=profile-header-image accept=image/jpeg></fw-file-upload> </div> </div> </div> <div ng-include="\'modules/creator-blog/customize-landing-page-submission-area.html\'"></div> </div> </div> </div>'),a.put("modules/creator-blog/customize-landing-page-loading-area.html","<fw-error-message value=model.errorMessage></fw-error-message>"),a.put("modules/creator-blog/customize-landing-page-submission-area.html",'<div class=row-btn> <div ng-show="form.submissionSucceeded && form.$pristine" class="alert alert-success"> <p>Saved successfully</p> </div> <div ng-show=form.message class="alert alert-danger form-message"> <p>{{form.message}}</p> </div> <div ng-show="form.hasAttemptedSubmit && !form.$valid" class="alert alert-danger form-invalid-message"> <p>Please correct all invalid fields before proceeding.</p> </div> <button type=submit class="btn btn-block btn-success save-changes-button" data-loading-text=Saving... data-event-title="Customize Landing Page form submitted" data-event-category="Customize Landing Page" ng-disabled="form.$pristine || form.isSubmitting" fw-form-submit=submitForm()> Save Changes </button> <fw-form-cancel-button ng-disabled="form.$pristine || form.isSubmitting" class=form-cancel-button></fw-form-cancel-button> </div>'),a.put("modules/creator-blog/customize-landing-page.html",'<div class=row> <div class=col-xs-12> <form novalidate id=customizeLandingPageForm role=form name=form> <tabset> <tab heading=Basics> <div ng-include="\'modules/creator-blog/customize-landing-page-basics.html\'"></div> </tab> <tab heading="Header Image"> <div ng-include="\'modules/creator-blog/customize-landing-page-header-image.html\'"></div> </tab> <tab heading="Full Description"> <div ng-include="\'modules/creator-blog/customize-landing-page-full-description.html\'"></div> </tab> </tabset> <fw-form-dirty-confirmation form=form></fw-form-dirty-confirmation> </form> </div> </div>'),a.put("modules/creator-compose/compose-create-collection-dialog.html",'<form novalidate role=form name=createCollectionForm id=create-collection-form> <fw-form-modal name="Create Collection" id-prefix=create-collection> <form-body> <fw-form-input-collection-name input-id=new-collection-modal-input ng-model=model.input.newCollectionName placeholder="New collection name" required focus></fw-form-input-collection-name> <fw-form-input-select ng-if="model.channels.length > 1" selected-item=model.input.selectedChannel items=model.channels></fw-form-input-select> </form-body> <form-buttons> <button id=create-collection-button class="btn btn-block btn-success" data-loading-text="Please wait..." data-event-title="New collection selected" data-event-category="New post" form-name=createCollectionForm can-submit=createCollectionForm.$valid fw-form-submit=submit()>Continue</button> </form-buttons> </fw-form-modal> </form>'),a.put("modules/creator-compose/compose-file.html","<div class=form-group> <div class=row> <div class=col-xs-12 ng-class=\"{'btn-file-change': fileName}\"> <p class=file-name ng-if=fileName>{{fileName}}</p> <fw-file-upload description=\"{{fileName ? 'Change' : 'Upload File'}}\" on-upload-complete=onUploadComplete(data) file-purpose=post-file accept=\"\"></fw-file-upload> </div> </div> </div>"),a.put("modules/creator-compose/compose-image.html",'<div class="form-group form-group-has-buffers"> <div class=row> <div class="col-s-7 bottom-buffer"> <fw-blob-image control=blobImage thumbnail=preview></fw-blob-image> <small class=sub-image-input>We recommend images at least 1200 pixels wide.</small> </div> <div class="col-s-5 bottom-buffer"> <fw-file-upload description="Upload Image" on-upload-complete=onUploadComplete(data) file-purpose=post-image accept=image/tiff,image/jpeg,image/gif,image/png></fw-file-upload> </div> </div> </div>'),a.put("modules/creator-compose/compose-note.html",'<fw-form-modal-title name="New Announcement"></fw-form-modal-title> <div ng-show=!model.postLater> <form novalidate name=contentForm id=content-form> <div class="modal-body form-modal-body"> <fw-form-input-note ng-model=model.input.note required focus></fw-form-input-note> <div ng-if="model.channels.length > 1"> <fw-form-input-select input-id=model-input-selected-channel selected-item=model.input.selectedChannel items=model.channels></fw-form-input-select> </div> </div> <fw-error-message value=model.errorMessage></fw-error-message> <div class=row-btn> <button type=submit class="btn btn-block btn-success" data-loading-text=Posting... data-event-title="Note posted" data-event-category="New post" fw-form-submit=postNow()>Post Now</button>  <button class="btn btn-default btn-block" ng-disabled=contentForm.isSubmitting fw-form-submit=postLater()>Schedule</button> </div> </form> </div> <div ng-show=model.postLater> <form novalidate name=scheduleForm id=schedule-form> <div class="modal-body form-modal-body"> <label>On specific date and time (UTC):</label> <fw-form-input-date-time-picker ng-model=model.input.date></fw-form-input-date-time-picker> </div> <div class=row-btn> <button type=submit class="btn btn-block btn-success" data-loading-text=Scheduling... data-event-title="Note scheduled" data-event-category="New post" fw-form-submit=postToBacklog()>Schedule</button>  <button class="btn btn-default btn-block" ng-disabled=scheduleForm.isSubmitting ng-click=cancelPostLater()>Cancel</button> </div> </form> </div>'),a.put("modules/creator-compose/compose-upload.html",'<fw-form-modal-title name="Post {{postType}}"></fw-form-modal-title> <div class=compose-upload-form> <div ng-show=!model.postLater> <form novalidate name=contentForm id=content-form> <div class="modal-body form-modal-body"> <div ng-include="\'modules/creator-compose/compose-\' + uploadFormFile + \'.html\'"></div> <div ng-if=model.fileUploaded> <fw-form-input-comment ng-model=model.input.comment placeholder="Add a comment, if you like" focus></fw-form-input-comment> <div ng-if=!model.createCollection> <label>Collection</label> <fw-form-input-select-collection id=model-input-selected-collection selected-item=model.input.selectedCollection items=model.collections create-new-collection-disabled=contentForm.isSubmitting create-new-collection=createNewCollection()></fw-form-input-select-collection> </div> <div ng-if=model.createCollection id=new-collection-area> <label>Collection</label> <fw-form-input-collection-name input-id=new-collection-area-input ng-model=model.input.newCollectionName placeholder="New collection name" ng-required=model.createCollection show-help></fw-form-input-collection-name> <fw-form-input-select ng-if="model.channels.length > 1" selected-item=model.input.selectedChannel items=model.channels></fw-form-input-select> </div> <fw-error-message value=model.errorMessage></fw-error-message> <fw-error-message value=contentForm.message></fw-error-message> </div> </div> <div class=row-btn ng-if=model.fileUploaded> <button type=submit class="btn btn-block btn-success" data-loading-text=Posting... data-event-title="{{postType}} posted" data-event-category="New post" can-submit=contentForm.$valid fw-form-submit=postNow()>Post Now</button> <button class="btn btn-default btn-block" ng-disabled=contentForm.isSubmitting can-submit=contentForm.$valid fw-form-submit=postLater()>Schedule</button> </div> </form> </div> <div ng-show=model.postLater class=compose-upload-schedule> <form novalidate name=scheduleForm id=schedule-form> <div class="modal-body form-modal-body"> <div class=form-group> <div class="radio bottom-buffer-l"> <label><input type=radio ng-model=model.postToQueue ng-value="true"> After other posts in queue <span ng-if="!model.queuedLiveDate && !shouldCreateCollection()">(loading...)</span> <span ng-if=model.queuedLiveDate>(will appear <strong>{{model.queuedLiveDate | date:fifthweekConstants.longDateTimeFormat:\'UTC\'}}</strong>)</span> </label> </div> <div class="radio bottom-buffer"> <label><input type=radio ng-model=model.postToQueue ng-value="false"> On specific date and time (UTC):</label> </div> <fw-form-input-date-time-picker ng-model=model.input.date></fw-form-input-date-time-picker> </div> <fw-error-message value=model.errorMessage></fw-error-message> <fw-error-message value=scheduleForm.message></fw-error-message> </div> <div class=row-btn> <button type=submit class="btn btn-block btn-success" data-loading-text=Scheduling... data-event-title="{{postType}} scheduled" data-event-category="New post" can-submit=scheduleForm.$valid fw-form-submit=postToBacklog()>Schedule</button>  <button class="btn btn-default btn-block" ng-disabled=scheduleForm.isSubmitting ng-click=cancelPostLater()>Back</button> </div> </form> </div> </div>'),a.put("modules/creator-compose/directives/compose-options.html",'<div class=post-new> <fw-panel12> <ul class=post-new-options> <li class=post-new-options-image><a id=post-image-link ng-click=newImage() href><span>Image</span></a></li> <li class=post-new-options-file><a id=post-file-link ng-click=newFile() href><span>File</span></a></li> <li class="post-new-options-video post-new-options-disabled"><a href><span>Video</span></a></li> <li class="post-new-options-audio post-new-options-disabled"><a href><span>Audio</span></a></li> <li class="post-new-options-article post-new-options-disabled"><a href><span>Article</span></a></li> </ul> </fw-panel12> <p class=post-new-announcement> Want to say something to your subscribers? <a id=post-note-link class=post-new-announcement-link ng-click=newAnnouncement() href>Make an announcement</a> </p> </div>'),a.put("modules/creator-posts/creator-posts.html","<fw-compose-options></fw-compose-options> <fw-post-list source=creator-posts></fw-post-list>"),a.put("modules/creator-timeline/creator-timeline.html",'<form novalidate name=form role=form> <fw-azure-image-loader output-url=model.profileImageUrl thumbnail=header file-id={{model.accountSettings.profileImage.fileId}} container-name={{model.accountSettings.profileImage.containerName}}></fw-azure-image-loader> <fw-azure-image-loader output-url=model.headerImageUrl thumbnail=header file-id={{model.blog.headerImage.fileId}} container-name={{model.blog.headerImage.containerName}}></fw-azure-image-loader> <div class=header-image ng-style="{\'background-image\':\'url(\' + (model.blog.headerImage.fileId ? model.headerImageUrl : model.defaultHeaderImageUrl) + \')\'}" id=header-image> <div class=header-image-control-overlay> <h1 class=fifthweek-logo-sm> <a ui-sref=creators>fw</a> </h1> <a id=edit-page-link class="btn btn-transparent btn-transparent-emphasized" ui-sref=creators.landingPage.edit> edit page </a> </div> </div> <div class=main-content> <div class=left-margin-offset> <div class="row header"> <div class=col-s-4> <div class=creator> <fw-image id=profile-image src="{{model.accountSettings.profileImage.fileId ? model.profileImageUrl : model.defaultProfileImageUrl}}"></fw-image> <div ng-if=model.subscribed class=subscribed> <div class=subscribe-button-wrapper> <button id=subscribed-button class="btn btn-block" type=submit data-event-title=Unsubscribed data-event-category={{model.tracking.category}} data-loading-text=Unsubscribing... can-submit=true fw-form-submit=unsubscribe()>Subscribed</button> </div> <p class=button-footer>1 Subscriber</p> </div> <div ng-if=!model.subscribed class=subscribe> <div class=subscribe-button-wrapper> <button id=subscribe-button class="btn btn-block" type=submit data-event-title={{model.tracking.title}} data-event-category={{model.tracking.category}} data-loading-text=Subscribing... can-submit=true fw-form-submit=subscribe()>Subscribe <span>&#36;{{model.totalPrice}}/week</span></button> </div> <p class=button-footer>No commitments. Cancel anytime.</p> </div> </div> </div> <div class=col-s-8> <div class=header-text> <h2 id=blog-name>{{model.blog.blogName}}</h2> <h3 id=blog-tagline>{{model.blog.tagline}}</h3> <h4 id=blog-introduction>{{model.blog.introduction}}</h4> </div> </div> </div> <div class=row> <div class="col-lg-8 col-lg-offset-4"> <div class="posts landing-page" ng-if=!model.subscribed> <h5><span>What You\'ll Get</span></h5> <div class="post non-image-post channels"> <div class=text> <div class=content> <div id=channel-{{$index}} class="row channel" ng-repeat="channel in model.channels" ng-class="{first:$first, last:$last}"> <div class=col-xs-7> <h6 class=channel-name>{{channel.name}}</h6> </div> <div class="col-xs-5 channel-price-column"> <span class=channel-price id=channel-price-{{$index}} ng-click="channel.checked = !channel.checked || channel.isDefault" ng-class="{\'unchecked\':!channel.checked, \'checked\':channel.checked, \'non-default\':!channel.isDefault, \'default\':channel.isDefault}"> &#36;{{channel.price}}/week </span> </div> <div class=col-xs-8> <ul class=channel-description> <li ng-repeat="descriptionLine in channel.description">{{descriptionLine}}</li> </ul> </div> </div> </div> <p class=subscribe-now-total> <span>Total:</span> &#36;{{model.totalPrice}}/week </p> <hr> <div class=subscribe-now> <p> <a href id=subscribe-link data-event-title={{model.tracking.title}} data-event-category={{model.tracking.category}} data-loading-text=Subscribing... can-submit=true fw-form-submit=subscribe()> Subscribe Now </a> </p> </div> </div> </div> <div id=more-info ng-if="model.videoUrl || model.blog.description"> <h5><span>More Info</span></h5> <div class="post non-image-post" ng-if=!model.videoUrl> <div class=text> <div id=full-description class=content> <fw-markdown replace=true ng-model=model.blog.description></fw-markdown> </div> </div> </div> <div class="post image-post" ng-if=model.videoUrl> <div id=video class=video> <embed-video data-ng-href={{model.videoUrl}} controls></embed-video> <div ng-include="\'views/partials/video-radius-fix.html\'"></div> </div> <div class=text> <div id=full-description class=content> <fw-markdown replace=true ng-model=model.blog.description ng-if=model.blog.description></fw-markdown> <p ng-if=!model.blog.description>More of your favourites each and every week -- for less than a coffee!</p> </div> </div> </div> </div> </div> <fw-post-list source=creator-timeline ng-if=model.subscribed></fw-post-list> </div> </div> </div> </div> </form>'),a.put("modules/newsfeed/newsfeed.html","<fw-panel12> <h4>Coming soon...</h4> <p>The news feed displays posts from other creators you are subscribed to.</p> </fw-panel12>"),a.put("modules/notifications/notifications.html","<fw-panel12> <h4 class=text-suffix>No new notifications</h4> <p>You have no new notifications.</p> </fw-panel12>"),a.put("modules/posts/full-size-image-modal.html",'<div class=modal-body ng-click=$close()> <a ng-click=$close()> <div class="image-button image-button-close"> <i class="fa fa-close"></i> </div> </a> <a ng-click=openFile(image)> <div class=image-button> <i class="fa fa-external-link"></i> </div> </a> <img ng-src={{imagePath}} class="img-responsive"> </div>'),a.put("modules/posts/fw-post-list.html",'<div class=posts ng-class="{ \'tagged-posts\': source ===  sources.creatorBacklog }"> <div ng-if="model.isLoading && !model.errorMessage" class=updating-area> <i class="fa fa-refresh fa-spin"></i> </div> <fw-error-message value=model.errorMessage></fw-error-message> <div ng-repeat="post in model.posts track by post.postId" ng-include="\'modules/posts/post.html\'" id=post-{{$index}}></div> <fw-panel12 ng-if="model.posts.length === 0 && source ===  sources.creatorBacklog"> <h4>Nothing scheduled</h4> <p>The schedule makes it easy for you to provide a steady flow of posts to your subscribers.</p> <p>Use this feature by clicking \'Schedule\' when creating a post.</p> </fw-panel12> <fw-panel12 ng-if="model.posts.length === 0 && source ===  sources.creatorPosts"> <h4>Blog empty</h4> <p>Your blog contains no live posts. Add posts to your blog by clicking \'New Post\' in the menu.</p> </fw-panel12> <fw-panel12 ng-if="model.posts.length === 0 && source ===  sources.creatorTimeline"> <h4>This creator has not released any posts</h4> <p>Don\'t panic! You will only be billed for the weeks where you receive content.</p> <p>Hopefully something will come along shortly :)</p> </fw-panel12> </div>'),a.put("modules/posts/post-edit-dialog.html",'<form novalidate role=form name=editPostForm class=edit-post-form> <fw-form-modal name="Edit Post"> <form-body> <div ng-if="model.postType !== postTypes.note"> <div class="form-group form-group-has-buffers" ng-if="model.postType === postTypes.file"> <label>File</label> <div class=row> <div class="col-s-6 bottom-buffer"> <p> <a class="btn-file-download file-content" ng-click=openFile(model.input.file)> {{model.input.fileSource.fileName}}.{{model.input.fileSource.fileExtension}} </a> </p> </div> <div class="col-s-6 bottom-buffer"> <fw-file-upload class=pull-right description="Upload File" on-upload-complete=onUploadComplete(data) file-purpose=post-file></fw-file-upload> </div> </div> </div> <div class="form-group form-group-has-buffers" ng-if="model.postType === postTypes.image"> <label>Image</label> <div class=row> <div class="col-s-7 bottom-buffer"> <fw-blob-image control=blobImage file-id={{model.input.image.fileId}} container-name={{model.input.image.containerName}} thumbnail=preview></fw-blob-image> </div> <div class="col-s-5 bottom-buffer"> <fw-file-upload description="Upload Image" on-upload-complete=onUploadComplete(data) file-purpose=post-image accept=image/tiff,image/jpeg,image/gif,image/png></fw-file-upload> </div> </div> </div> <label>Comment</label> <fw-form-input-comment ng-model=model.input.comment placeholder="Add a comment, if you like" focus> </fw-form-input-comment> <label>Post to</label> <fw-form-input-select selected-item=model.input.selectedCollection items=model.collections ng-disabled=true></fw-form-input-select> </div> <div ng-if="model.postType === postTypes.note"> <label>Note</label> <fw-form-input-note ng-model=model.input.comment required focus></fw-form-input-note> <label>Share with</label> <div ng-if="model.channels.length > 1"> <fw-form-input-select selected-item=model.input.selectedChannel items=model.channels ng-disabled=true></fw-form-input-select> </div> </div> <div class=form-group> <fw-form-subsection name="Release time"> <summary> <p ng-if="model.savedScheduleMode === scheduleModes.now">This post has been released.</p> <p ng-if="model.savedScheduleMode !== scheduleModes.now">Currently scheduled for <strong>{{model.savedDate | date:fifthweekConstants.longDateTimeFormat:\'UTC\'}}</strong>.</p> </summary> <section> <div class=radio> <label><input type=radio ng-model=model.input.scheduleMode ng-value="scheduleModes.now"> {{model.savedScheduleMode === scheduleModes.now ? \'No change\' : \'Post now\'}}</label> </div> <div class=radio ng-if="model.postType !== postTypes.note"> <label> <input type=radio ng-model=model.input.scheduleMode ng-value="scheduleModes.queued"> Schedule with queue <span ng-if="model.savedScheduleMode !== scheduleModes.queued">(will appear <strong>{{model.queuedLiveDate | date:fifthweekConstants.longDateTimeFormat:\'UTC\'}}</strong>)</span> </label> </div> <div class=radio> <label><input type=radio ng-model=model.input.scheduleMode ng-value="scheduleModes.scheduled"> Schedule for specific time (UTC):</label> </div> <fw-form-input-date-time-picker ng-model=model.input.date></fw-form-input-date-time-picker> </section> </fw-form-subsection> </div> <fw-error-message value=editPostForm.message></fw-error-message> </form-body> <form-buttons> <button id=save-post-button class="btn btn-block btn-success" data-loading-text=Saving... data-event-title="Backlog post edited" data-event-category="Edited post" fw-form-submit=save()> <span ng-if="model.savedScheduleMode === scheduleModes.now">{{model.input.scheduleMode === scheduleModes.now ? \'Save\' : \'Schedule\'}}</span> <span ng-if="model.savedScheduleMode !== scheduleModes.now">{{model.input.scheduleMode === scheduleModes.now ? \'Post Now\' : \'Save\'}}</span> </button> </form-buttons> </fw-form-modal> </form>'),a.put("modules/posts/post.html",'<h5 ng-if="source ===  sources.creatorTimeline && post.dayGrouping"> <span class=day-grouping>{{post.liveDate | date:fifthweekConstants.dayGroupingDateFormat:\'UTC\'}}</span> </h5> <div data-live-date={{post.liveDate}} class="post timeline-post" ng-class="{\'non-image-post\': !post.image, \'image-post\': post.image}"> <div ng-if="post.image && post.renderSizeRatio" class=full-width-image-container> <div ng-style="{\'padding-top\': post.renderSizeRatio}"></div> <img class=full-width-image ng-if=post.image ng-src={{post.image.resolvedUri}} ng-click="post.fileSource ? openFile(post.image) : viewImage(post.image, post.imageSource)"> </div> <img ng-if="post.image && !post.renderSizeRatio" class=full-width-image ng-src={{post.image.resolvedUri}} ng-click="post.fileSource ? openFile(post.image) : viewImage(post.image, post.imageSource)"> <div ng-if=post.isScheduled> <p class=tag ng-if=!post.scheduledByQueue>Scheduled, {{post.liveDate | date:fifthweekConstants.newsfeedDateFormat:\'UTC\'}}</p> <p class=tag ng-if=post.scheduledByQueue>Queued, {{post.liveDate | date:fifthweekConstants.newsfeedDateFormat:\'UTC\'}}</p> </div> <div class=text> <div class=content ng-if="post.comment || post.fileSource"> <span fw-markdown id=post-comment ng-model=post.comment ng-if=post.comment></span> <span id=post-link ng-if=post.fileSource> <p> <a class="btn-file-download file-content" ng-click=openFile(post.file)> {{post.fileSource.fileName}}.{{post.fileSource.fileExtension}} </a> <span class=file-size>{{post.fileSource.readableSize}}</span> </p> </span> </div> <hr> <div class="row info-actions"> <div class="col-xs-8 info"> <a class=author ui-sref=account> <img class=author-image ng-src="{{post.creator.profileImage.resolvedUri}}"> </a> <ul> <li> <a ui-sref=account class=poster-name> {{post.creator.username}} </a> <span ng-if=post.collection> in <a ui-sref="creators.collections.edit({id: post.collectionId})" class=container-name> {{post.collection.name}} </a> </span> <span ng-if=!post.collection> to <a ui-sref="creators.channels.edit({id: post.channelId})" class=container-name> {{post.channel.isDefault ? \'Everyone\' : post.channel.name}} </a> </span> </li> <li> <a ng-click=editPost(post) class=live-in-info> <span ng-if=post.isScheduled>live </span>{{post.liveIn}} </a> </li> </ul> </div> <div class="col-xs-4 actions"> <ul> <li class=actions-more> <span class=dropdown dropdown on-toggle=toggled(open)> <button class=dropdown-toggle dropdown-toggle> <i class="fa fa-ellipsis-h"></i> </button> <ul class=dropdown-menu> <li><a ng-click=editPost(post)>Edit</a></li> <li ng-if="post.isScheduled && post.scheduledByQueue"><a ng-click=post.reorder()>Reorder</a></li> <li> <fw-delete-link item-type=Post event-title="Post deleted" event-category={{sourceName}} delete=deletePost(post.postId)> Delete </fw-delete-link> </li> </ul> </span> </li> </ul> </div> </div> </div> </div>'),
a.put("views/coming-soon.html","<fw-panel12> <h4>Coming soon...</h4> <p>We are working hard on implementing this feature!</p> </fw-panel12>"),a.put("views/help/contact-us.html",'<div class=row> <div class=col-md-12> <div class="panel panel-default"> <div class="panel-body jumbo-panel"> <h4>Drop us a line!</h4> <p>We’d love to talk: questions, complaints, praise, feature requests – anything. Please let us know what we can do to improve Fifthweek.</p> <br> <p class=last><strong> <a id=mailto-link href="mailto:hello@fifthweek.com?subject=Feedback&body=Hi Fifthweek! This is my feedback:" analytics-category=Link analytics-event="Clicked &quot;hello@fifthweek.com&quot;" analytics-on>hello@fifthweek.com</a></strong></p> </div> </div> </div> </div>'),a.put("views/help/faq.html",'<div class=row> <div class=col-lg-12> <div class="panel panel-default"> <div class="panel-body jumbo-panel"> <h4>What is Fifthweek?</h4> <p>Somewhere to share content worth paying for - it\'s a premium blogging platform.</p> <p>Turns out that when people perceive any amount of value in something, they\'re usually happy to pay a small amount to receive it. All those great comics, video blogs and journalistic niches. We\'ll help to bring more of those to life. Not by donations or crowd-funding. Just simple micro-payments, motivated purely by awesome content.</p> <p><a ui-sref=home>Register as a creator</a>.</p> </div> </div> <div class="panel panel-default"> <div class="panel-body jumbo-panel"> <h4>When will the site be ready?</h4> <div class=row> <div class=col-sm-3> <p><strong>5th April 2015</strong></p> </div> <div class=col-sm-9> <p>Creators can design and populate their blogs.</p> </div> </div> <hr> <div class=row> <div class=col-sm-3> <p><strong>1st May 2015</strong></p> </div> <div class=col-sm-9> <p>Subscribers can setup paid blogs to creators, view content and discuss.</p> </div> </div> <hr> <div class=row> <div class=col-sm-3> <p><strong>And beyond...</strong></p> </div> <div class=col-sm-9> <p>We will be increasing functionality and generally making things run smoother. If you have a suggestion already, <a ui-sref=help.contact>please let us know!</a></p> </div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-body jumbo-panel"> <h4>I\'m a creator living in the EU, will VAT MOSS affect me?</h4> <p class=first>No, you will be transacting with us in a business-to-business relationship. Here\'s how it works:</p> <ol> <li>Prices are advertised to subscribers as GROSS. This means everyone sees the same price, and every subscriber pays the same amount.</li> <li>We will pay the correct VAT for that subscriber, meaning what\'s left over will change from country-to-country. This is the \'NET\' amount.</li> <li>We will take our 20&#37; fee from the NET amount, and pay you the remaining 80&#37; as a supplier.</li> <li>If you are VAT registered, we will pay you VAT ontop of that 80&#37;.</li> </ol> <h4>An example...</h4> <ol> <li>You create a blog and set a GROSS price of &#36;1.25.</li> <li>James from Sweden, like everyone else in the world, will pay &#36;1.25 for your blog.</li> <li>We will pay the correct Swedish VAT of 25&#37; out of that &#36;1.25 - i.e. VAT MOSS is handled our side.</li> <li>&#36;1.00 is left after paying VAT.</li> <li>We take &#36;0.20 and will pay you &#36;0.80</li> <li>&#42;If you are VAT registered&#42;, and let\'s assume in the UK, we will pay you 20&#37; ontop. That\'s &#36;0.96.</li> </ol> </div> </div> </div> </div>'),a.put("views/help/legal/index.html","<fw-panel-12> <p> <a ui-sref=help.legal.termsOfService ui-sref-active=strong>Terms of Service</a> | <a ui-sref=help.legal.privacyPolicy ui-sref-active=strong>Privacy Policy</a> </p> <div ui-view></div> </fw-panel-12>"),a.put("views/help/legal/privacy-policy.html",'<h4 class=not-first-child>Last Modified: December 21, 2014</h4> <p> Fifthweek LTD. ("Fifthweek," "we," "us," or "our") takes the private nature of your information very seriously. </p> <p> This is why we are looking to implement a clear Privacy Policy as a matter of priority. We apologise for any inconvenience caused by not having this document available at present. </p> <h4>Modifications to this Privacy Policy</h4> <p> Our Privacy Policy may change from time to time as per the process for modifications defined in our <a ui-sref=help.legal.termsOfService>Terms of Service</a>. Use of information we collect is subject to the Privacy Policy in effect at the time such information is collected. </p> <h4>Enquiries</h4> <p> Please <a id=mailto-link href=mailto:hello@fifthweek.com analytics-category=Link analytics-event="Clicked &quot;email us&quot; in privacy policy" analytics-on>email us</a> if you have any questions or concerns regarding privacy using this service. </p> <h4>Prior Versions</h4> <p> Prior versions of our Privacy Policy are available on GitHub, which also allows you to compare different versions and see what terms have changed: </p> <p> <a href=http://github.com/fifthweek/fifthweek-policy/commits/master/privacy-policy.txt>View older versions.</a> </p>'),a.put("views/help/legal/terms-of-service.html",'<h4 class=not-first-child>Last Modified: December 21, 2014</h4> <p> Please read these Terms of Service (the "Agreement") carefully before using fifthweek.com (the "Site") and/or the other domains, websites, products, applications, mobile applications, services, and/or Content (all of those collectively with the Site, the "Services") provided by Fifthweek LTD. ("Fifthweek," "we," or "us"). By using or accessing the Services, you ("User" or "you") agree to be bound by all the terms and conditions of this Agreement. If you don’t agree to all the terms and conditions of this Agreement, you shouldn\'t, and aren\'t permitted to, use the Services. </p> <h4>Modifications to this Agreement</h4> <p> Fifthweek reserves the right to modify this Agreement by (1) posting a revised Agreement on and/or through the Services and (2) providing notice to you that this Agreement has changed, generally via email, and otherwise through the Services. Modifications will not apply retroactively. You are responsible for reviewing and becoming familiar with any modifications to this Agreement. </p> <p> We may sometimes ask you to review and to explicitly agree to (or reject) a revised version of this Agreement. In such cases, modifications will be effective at the time of your agreement to the modified version of this Agreement. If you do not agree at that time, you are not permitted to use the Services. </p> <p> In cases where we do not ask for your explicit agreement to a modified version of this Agreement, but otherwise provide notice as set forth above, the modified version of this Agreement will become effective fourteen (14) days after we have posted the modified Agreement and provided you notification of the modifications. Your use of the Services following that period constitutes your acceptance of the terms and conditions of this Agreement as modified. If you do not agree to the modifications, you are not permitted to use, and should discontinue your use of, the Services. </p> <h4>Use of the Services</h4> <p> No individual under the age of thirteen (13) may use the Services, provide any personal information to Fifthweek, or otherwise submit personal information through the Services (including, for example, a name, address, telephone number, or email address). You cannot use the Services if you are legally prohibited from doing so. </p> <p> Fifthweek retains the right to create limits on and related to use of the Services in its sole discretion at any time with or without notice. Fifthweek may also impose limits on certain Services or aspects of those Services or restrict your access to parts or all of the Services without notice or liability. Fifthweek may change, suspend, or discontinue any or all of the Services at any time, including the availability of any product, feature, database, or Content (as defined below). Fifthweek may also terminate or suspend accounts at any time, in its sole discretion. </p> <h4>Prior Versions</h4> <p> Prior versions of our Terms of Service are available on GitHub, which also allows you to compare different versions and see what terms have changed: </p> <p> <a href=http://github.com/fifthweek/fifthweek-policy/commits/master/terms-of-service.txt>View older versions.</a> </p>'),a.put("views/home-modal.html",'<div class="modal-body has-modal-cross-button-outside"> <a id=modal-cross-button class=modal-cross-button-outside ng-click=$close() href> <i class="fa fa-close"></i> </a> <div class=video>  <iframe id=home-modal-video vimeo-video title="Creator Journey" src="//player.vimeo.com/video/114229222?player_id=home-modal-video" frameborder=0 webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> </div> </div>'),a.put("views/home.html",'<div ng-include="\'views/partials/logo.html\'"></div> <a id=sign-in-link ui-sref=signIn class="btn btn-transparent btn-signin">Sign In</a> <div class="row home-intro"> <div class=col-md-12> <h2 id=intro-heading>Comics, photos, <br>videos, blogs.</h2> <h3 id=intro-sub-heading>Bring more of your best creations to life. Launch your own subscription.</h3> <div class=form-wrap> <form novalidate autocomplete=off role=form name=form id=registrationForm> <div ng-show=!registrationSucceeded> <div class=input-wrap> <fw-form-group> <div class=row> <div class=col-md-6> <div fw-form-input-glyphs> <input id=registrationData-email ng-model=registrationData.email type=email class=form-control name=email placeholder=Email required> </div> </div> <div class=col-md-6> <p fw-form-input-invalid-p>A valid email address is required.</p> </div> </div> </fw-form-group> <fw-form-input-username ng-model=registrationData.username breakpoint=md required></fw-form-input-username> <fw-form-input-password ng-model=registrationData.password placeholder=Password breakpoint=md required></fw-form-input-password> </div> <div class="row row-btn"> <div class=col-md-6> <button class="btn btn-success btn-lg btn-block" type=submit id=register-button data-loading-text=Registering... data-event-title=Registered data-event-category=Registration fw-form-submit=register()>Register as creator</button> </div> </div> </div> <div class=row> <div class=col-md-6> <div id=messageBox class=sub-form-alert ng-show=form.message ng-class="registrationSucceeded ? \'alert alert-success\' : \'alert alert-danger\'"> <p>{{form.message}}</p> </div> </div> </div> </form> <div class=row> <div class=col-md-6> <a id=play-video-link class="btn btn-lg btn-transparent-text btn-video" ng-class="{\'fade-out\': form.$dirty}" ng-href ng-click=openModal()><i class="fa fa-play"></i> Play the video</a> </div> </div> </div> </div> </div> <div class="row home-footer"> <div class=col-md-12> <div class="row text-wrap"> <p><strong>Fifthweek is for sharing quality content.</strong> <span>We make it really simple for creators to make a low-cost subscription and share whatever they want through it. <br><a ui-sref=help.faq>Learn more</a></span></p> </div> </div> </div>'),a.put("views/not-authorized.html",'<div class=row> <div class=col-lg-12> <div class="panel panel-default"> <div class="panel-body jumbo-panel">You are not authorized to view this page.</div> </div> </div> </div>'),a.put("views/not-found.html","<fw-panel12> <h4>Not Found</h4> <p>The page you requested could not be found.</p> </fw-panel12>"),a.put("views/partials/blob-image.html",'<div ng-controller=blobImageCtrl class=image-container> <div class=vertical-aspect-ratio></div> <div ng-if=model.imageUri class=thumbnail-area> <img ng-src={{model.imageUri}} class="image-area available-image" ng-style="model.renderSize"> </div> <div ng-if=model.errorMessage class="image-area error-area pending-image" ng-style=model.renderSize> <i class="fa fa-exclamation-circle"></i> </div> <div ng-if=model.updating class="image-area updating-area pending-image" ng-style=model.renderSize> <i class="fa fa-refresh fa-spin"></i> </div> <div ng-if="!model.updating && !model.imageUri && !model.errorMessage" class="image-area blank-area pending-image" ng-style=model.renderSize> <i class="fa fa-camera"></i> </div> </div>'),a.put("views/partials/breadcrumb.html",'<div class=row> <div class=col-xs-12> <h4 id=breadcrumb> <a class=item ui-sref={{rootState}}><i class={{rootIcon}}></i> {{rootName}}</a> <span ng-repeat="item in intermediateStates"> <i class="fa fa-angle-right"></i> <a class=item ng-click=item.click() href>{{item.name}}</a> </span> <span class=item> <i class="fa fa-angle-right"></i> <span>{{current}}</span> </span> </h4> </div> </div>'),a.put("views/partials/delete-link.html",' <a id={{linkId}} class={{class}} href ng-controller=deleteLinkCtrl ng-click=verifyDelete() ng-transclude=""></a>'),a.put("views/partials/delete-verification.html",'<form novalidate role=form name=verifiedDeleteForm ng-if=model.item> <fw-form-modal name="Delete {{model.itemType}}"> <form-body> <h5>Are you ABSOLUTELY sure?</h5> <p> This action CANNOT be undone. This will permanently delete <strong id=delete-hint>{{model.item}}</strong>. All associated content and comments will be removed. </p> <div class=form-group> <label for=deletion-confirmation-text>Please type in the name of the {{model.itemTypeLowered}}</label> <input id=deletion-confirmation-text name=confirmationText ng-model=model.confirmationText class=form-control focus=true required> </div> <fw-error-message value=verifiedDeleteForm.message></fw-error-message> </form-body> <form-buttons> <button id=delete-item-verified-button class="btn btn-block btn-danger" data-loading-text=Deleting... data-event-title={{model.dataEventTitle}} data-event-category={{model.dataEventCategory}} ng-disabled="verifiedDeleteForm.isSubmitting || model.item !== model.confirmationText" fw-form-submit=confirmDelete()>I understand, delete this {{model.itemTypeLowered}}</button> </form-buttons> </fw-form-modal> </form> <form novalidate role=form name=unverifiedDeleteForm ng-if=!model.item> <fw-form-modal name="Delete {{model.itemType}}"> <form-body> <div class=form-group> <p> Are you sure you want to delete this? </p> </div> <fw-error-message value=unverifiedDeleteForm.message></fw-error-message> </form-body> <form-buttons> <button id=delete-item-unverified-button class="btn btn-block btn-danger" data-loading-text=Deleting... data-event-title={{model.dataEventTitle}} data-event-category={{model.dataEventCategory}} can-submit=true fw-form-submit=confirmDelete()>Delete {{model.itemType}}</button> </form-buttons> </fw-form-modal> </form>'),a.put("views/partials/error-message.html",'<div ng-if=value class="alert alert-danger" ng-class=class> <p> {{value}} </p> </div>'),a.put("views/partials/file-upload.html","<div ng-controller=fileUploadCtrl class=btn-file-container> <div ng-if=!model.fileApiSupported id=file-upload-not-supported-area> <label>Sorry, we do not support uploading files with your current browser.</label> </div> <div ng-if=model.fileApiSupported> <div ng-if=!model.isSubmitting id=file-upload-button-area>  <span class=\"btn btn-default btn-block btn-file\">{{description || 'Upload'}}<input id=file-upload-button-input type=file fw-file-input-on-change=upload(files) accept={{accept}}></span> </div> <div ng-if=model.isSubmitting class=progress-container id=file-upload-progress-area> <progressbar value=model.progress type=success></progressbar> <p ng-if=abbreviateProgress class=progress-text>{{model.progress}}%</p> <p ng-if=!abbreviateProgress class=progress-text>Uploading: {{model.progress}}% complete</p> </div> <div class=has-error ng-if=model.errorMessage id=file-upload-error-area> <p class=help-block> {{model.errorMessage}} </p> </div> </div> </div>"),a.put("views/partials/form-group.html","<div class=form-group ng-class=\"{\n     'has-error': input.$invalid && ((input.$touched && input.$dirty) || form.$submitted),\n     'has-success': input.$valid && ((input.$touched && input.$dirty) || form.$submitted)\n   }\" ng-transclude=parent> </div>"),a.put("views/partials/form-input-comment.html","<fw-form-group input-name=comment> <div class=row> <div class=col-xs-12> <textarea id={{inputId}} name=comment ng-model=ngModel[ngModelAccessor] class=form-control placeholder={{placeholder}} ng-maxlength=2000 maxlength=2000 focus={{focus}} msd-elastic></textarea> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=maxlength>Allowed 2000 characters at most.</p> </div> </div> </fw-form-group>"),a.put("views/partials/form-input-delete.html",'<div class=btn-delete-item> <hr class="visible-under-s"> <p class=btn-alternate-action> <fw-delete-link link-id={{linkId}} class=text-danger item=item item-type={{itemType}} data-event-title={{dataEventTitle}} data-event-category={{dataEventCategory}} delete=delete()> Delete {{itemType}} </fw-delete-link> </p> </div>'),a.put("views/partials/form-input-note.html",'<fw-form-group input-name=note> <div class=row> <div class=col-xs-12> <textarea id={{inputId}} class="form-control form-control-lines-2" name=note ng-model=ngModel[ngModelAccessor] placeholder="What\'s happening?" focus={{focus}} ng-required=isRequired() ng-disabled=isDisabled() ng-maxlength=280 maxlength=280 msd-elastic></textarea> </div> <div class=col-xs-12> <p fw-form-input-invalid-p=required>Please write your note before continuing.</p> <p fw-form-input-invalid-p=maxlength>Allowed 280 characters at most.</p> </div> </div> </fw-form-group>'),a.put("views/partials/form-input-password.html","<fw-form-group input-name=password> <label ng-if=label for={{inputId}}>{{label}}</label> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} ng-model=ngModel[ngModelAccessor] name=password type=password class=form-control placeholder={{placeholder}} ng-minlength=6 ng-maxlength=100 maxlength=100 focus={{focus}} ng-required=required> </div> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=minlength>Must be at least 6 characters.</p> <p fw-form-input-invalid-p=maxlength>Allowed 100 characters at most.</p> <span ng-if=required> <p fw-form-input-invalid-p=required>A password is required.</p> </span> </div> </div> </fw-form-group>"),a.put("views/partials/form-input-select.html",'<div class=form-group> <div class=row> <div class="col-xs-12 col-s-7 col-sm-6"> <div class=select> <select id={{inputId}} class=select-full-width ng-disabled=ngDisabled ng-model=selectedItem ng-options="item.name for item in items"></select> </div> </div> </div> </div>'),a.put("views/partials/form-input-username.html",'<fw-form-group input-name=username> <label ng-if=label for={{inputId}}>{{label}}</label> <div class=row> <div class=col-{{breakpoint}}-6> <div fw-form-input-glyphs> <input id={{inputId}} class=form-control name=username placeholder=Username ng-model=ngModel[ngModelAccessor] ng-model-options="{ debounce: 500 }" ng-pattern="/^[a-zA-Z0-9_]+$/" ng-minlength=2 ng-maxlength=20 maxlength=20 focus={{focus}} ng-required=required fw-check-username-availability> </div> </div> <div class=col-{{breakpoint}}-6> <p fw-form-input-invalid-p=pattern>Letters, numbers and underscores only.</p> <p fw-form-input-invalid-p=minlength>Must be at least 2 characters.</p> <p fw-form-input-invalid-p=maxlength>Allowed 20 characters at most.</p> <p fw-form-input-invalid-p=required>A username is required.</p> <p ng-if=form.username.$pending.username class=help-block>Checking availability...</p> <p ng-if=form.username.$error.username class=help-block>This username is already taken!</p> </div> </div> </fw-form-group>'),a.put("views/partials/form-modal-title.html",'<h4 id=modal-title> <a id={{idPrefix}}-cross-button class=btn-close href ng-click=$close()> <i class="fa fa-close"></i> </a> {{name}} </h4>'),a.put("views/partials/form-modal.html",'<fw-form-modal-title name={{name}} id-prefix={{idPrefix}}></fw-form-modal-title> <div class="modal-body form-modal-body"> <form-body-placeholder></form-body-placeholder> </div> <div class=row-btn> <form-buttons-placeholder></form-buttons-placeholder> <button id={{idPrefix}}-cancel-button class="btn btn-default btn-block" ng-click=$close()>Cancel</button> </div>'),a.put("views/partials/form-subsection.html",'<div class=form-subsection ng-class="{\'form-subsection-expanded\': formSubsection.expanded, \'form-subsection-collapsed\': !formSubsection.expanded}" ng-controller=formSubsectionCtrl> <div class=row> <div class=col-xs-9> <h5 class=form-group-heading> <a href ng-click="formSubsection.expanded = !formSubsection.expanded"> {{name}} </a> </h5> <div ng-class="{\'if-collapsed\': hasExpandedSummary}" class=form-subsection-summary> <summary-placeholder></summary-placeholder> </div> <div class=if-expanded ng-if=hasExpandedSummary> <summary-expanded-placeholder></summary-expanded-placeholder> </div> </div> <div class="col-xs-3 form-subsection-toggle"> <button ng-click="formSubsection.expanded = true; $event.preventDefault();" class="btn btn-default btn-slim if-collapsed btn-expand"> expand </button> <button ng-click="formSubsection.expanded = false; $event.preventDefault();" class="btn btn-default btn-slim if-expanded btn-collapse"> collapse </button> </div> <div class="col-xs-12 form-subsection-section if-expanded"> <section-placeholder></section-placeholder> </div> </div> </div>'),a.put("views/partials/header-sidebar-toggle.html",'<button type=button class=navbar-toggle snap-toggle=left> <i class="fa fa-navicon fa-lg"></i> </button>'),a.put("views/partials/header.html",'<header ng-controller=HeaderCtrl> <nav class="navbar navbar-default navbar-fixed-top" role=navigation bs-navbar> <div class=inner> <ng-include src="\'views/partials/header-sidebar-toggle.html\'" class=header-wrapper></ng-include> <div class=header-navbar-menu-wrap> <ul ng-if="navigation.length === 0" id=header-navbar class=header-navbar-menu> <li> <a class=active id=header-title snap-close> <span>{{$state.current.data.pageTitle}}</span> </a> </li> </ul> <ul ng-if="navigation.length > 0" id=header-navbar class=header-navbar-menu> <li ng-repeat="item in navigation"> <a ng-if=!item.separator ng-class="{active: item.isActive}" id=header-{{item.id}} ui-sref={{item.state}} snap-close> <span><i ng-class=item.icon></i></span> <span>{{item.name}}</span> </a> </li> </ul> </div> </div> </nav> </header>'),a.put("views/partials/logo.html","<h1 class=fifthweek-logo> <a ui-sref=home snap-close>fifthweek.</a> </h1>"),a.put("views/partials/managed-list-sm.html",'<div class=managed-list-sm> <div class="row-outer item" ng-repeat="item in items" ng-click="manageItem({item: item})"> <div class=row> <div class=col-xs-10 ng-transclude=parent> </div> <div class="col-xs-2 action"> <p><i class="fa fa-chevron-right"></i></p> </div> </div> </div> <div class=row-outer ng-click=newItem()> <div class=row> <div class=col-xs-9> <p>Add a new {{itemName}}</p> </div> <div class="col-xs-3 action"> <button class="btn btn-success btn-slim btn-add" ng-click=$event.preventDefault()> <span class=visible-over-s>add</span> <i class="fa fa-plus-circle btn-icon-right"></i> </button> </div> </div> </div> </div>'),a.put("views/partials/managed-list.html",'<div class=managed-list> <fw-panel12 class=managed-list-create ui-sref={{newItemState}}> <div class=row-selection-slim> <div class=row> <div class=col-xs-9> <h5><a href>Add a new {{itemName}}</a></h5> </div> <div class=col-xs-3> <button id=add-button class="btn btn-success btn-slim"> <span class=visible-over-s>add</span> <i class="fa fa-plus-circle btn-icon-right-collapsible"></i> </button> </div> </div> </div> </fw-panel12> <fw-panel12 ng-if="items.length > 0"> <div class="row-selection item" ng-repeat="item in items" ui-sref="{{manageItemState}}({id: item.id})"> <div class=row> <div class=col-xs-9 ng-transclude=parent> </div> <div class=col-xs-3> <button class="btn btn-default btn-slim"> <span class=visible-over-s>edit</span> <i class="fa fa-chevron-right btn-icon-right-collapsible"></i> </button> </div> </div> </div> </fw-panel12> </div>'),a.put("views/partials/sidebar.html",'<div id=sidebar class=sidebar snap-drawer=left data-ng-controller=SidebarCtrl> <div ng-include="\'views/partials/logo.html\'"></div> <ul> <li ng-repeat="item in navigation"> <hr ng-if="item.separator"> <a ng-if=!item.separator class={{item.color}} ng-class="{active: item.isActive}" id=sidebar-{{item.id}} ui-sref={{item.state}} snap-close> <i ng-class=item.icon></i>{{item.name}} </a> </li> </ul> </div> <div class=sidebar-footer> <p class=version><a ui-sref=help.faq snap-close>Public Beta</a></p> <p id=browserStackMention>Tested on <a ng-href="http://www.browserstack.com/" target=_blank>BrowserStack</a></p> <p>&copy; Fifthweek 2015</p> </div>'),a.put("views/partials/video-radius-fix.html",'<div class=video-radius-fix> <img src="/static/images/post-top-left-radius.5918225.png"> <img src="/static/images/post-top-right-radius.f1ebf8c.png"> </div>'),a.put("views/sign-in/forgot.html",'<form novalidate name=form role=form> <fw-panel6 ng-show=!form.submissionSucceeded id=password-reset-request-panel> <div class=form-group> <input id=passwordResetRequestData-username class=form-control placeholder=Username ng-model=passwordResetRequestData.username focus=true> </div> <h5 class=form-group>Or</h5> <div class=form-group> <input id=passwordResetRequestData-email class=form-control placeholder=Email ng-model=passwordResetRequestData.email> </div> <div class=row-btn> <button id=password-reset-request-button class="btn btn-success btn-block" type=submit data-event-title="Password reset requested" data-event-category=Sign-in data-loading-text="Sending request..." fw-form-submit=requestPasswordReset()>Reset Password</button> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert" id=password-reset-request-message> <p>{{form.message}}</p> </div> </fw-panel6> <fw-panel12 ng-show=form.submissionSucceeded id=password-reset-request-success> <h4 class="text-suffix text-success">Please check your inbox</h4> <p>You should receive an email from us containing a link to reset your password.</p> </fw-panel12> </form>'),a.put("views/sign-in/reset.html",'<form novalidate role=form name=form> <fw-panel12 ng-show="!form.submissionSucceeded && !tokenInvalid" id=password-reset-confirmation-panel> <fw-form-input-password ng-model=passwordResetConfirmationData.newPassword placeholder="New password" required focus></fw-form-input-password> <div class=row-btn> <button id=password-reset-confirmation-button class="btn btn-success btn-block" type=submit data-event-title="Password reset completed" data-event-category=Sign-in data-loading-text=Resetting... fw-form-submit=confirmPasswordReset()>Reset Password</button> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert" id=password-reset-confirmation-message> <p>{{form.message}}</p> </div> </fw-panel12> <fw-panel12 ng-show="form.submissionSucceeded && !tokenInvalid" id=password-reset-confirmation-success> <h4 class="text-suffix text-success">Password has been reset</h4> <p> Please sign in with your new password. <strong><a ui-sref=signIn>Continue to sign in page &raquo;</a></strong> </p> </fw-panel12> </form> <fw-panel12 ng-show=tokenInvalid id=password-reset-token-invalid> <h4 class="text-suffix text-warning">This link has expired</h4> <p> If you still need to reset your password, please go to the <strong><a ui-sref=signIn.forgot>forgot your details</a></strong> page. </p> </fw-panel12>'),a.put("views/sign-in/sign-in.html",'<fw-panel6> <form novalidate name=form role=form> <div class=form-group> <input id=signInData-username class=form-control placeholder=Username ng-model=signInData.username focus=true> </div> <div class=form-group> <input id=signInData-password type=password class=form-control placeholder=Password ng-model=signInData.password> </div> <div class=row-btn> <div class=row> <div class=col-s-4> <button id=sign-in-button class="btn btn-success btn-block" type=submit data-event-title="Signed in" data-event-category=Sign-in data-loading-text="Signing In..." fw-form-submit=signIn()>Sign In</button> </div> <div class=col-s-8> <p class=btn-alternate-action><a id=forgot-details-link ui-sref=signIn.forgot>Forgot your details?</a></p> </div> </div> </div> <div ng-show=form.message class="alert alert-danger sub-form-alert" id=sign-in-message> <p>{{form.message}}</p> </div> </form> </fw-panel6>'),a.put("views/signout.html","<div class=alert>Signing out...</div>")}]),angular.module("webApp").directive("datepickerPopup",["datepickerPopupConfig","dateParser","dateFilter",function(a,b,c){"use strict";return{restrict:"A",require:"^ngModel",link:function(b,d,e,f){var g=a.datepickerPopup;e.$observe("datepickerPopup",function(b){g=b||a.datepickerPopup,f.$render()}),f.$formatters.push(function(a){return f.$isEmpty(a)?a:c(a,g)})}}}]).directive("fwDateTimePicker",function(){"use strict";return{restrict:"E",require:["fwDateTimePicker","ngModel"],controller:"fwDateTimePickerCtrl",scope:{},templateUrl:"modules/common/fw-date-time-picker.html",link:function(a,b,c,d){var e=d[0],f=d[1];e.initialize(f)}}}),angular.module("webApp").controller("fwDateTimePickerCtrl",["$scope","fifthweekConstants",function(a,b){"use strict";var c=new Date;c.setUTCHours(c.getUTCHours()+1,0,0,0);var d,e=function(){var b;b=new Date(d.$modelValue?d.$modelValue:c);var e=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()),f=new Date(b);f.setUTCMinutes(f.getUTCMinutes()+f.getTimezoneOffset()),a.date=e,a.time=f},f=function(){if(a.date&&a.time){var b=new Date(Date.UTC(a.date.getFullYear(),a.date.getMonth(),a.date.getDate(),a.time.getHours(),a.time.getMinutes(),0,0));d.$setViewValue(b),d.$setValidity("dateTime",!0)}else d.$setViewValue(void 0),d.$setValidity("dateTime",!1)};a.dateOptions={formatYear:"yyyy",startingDay:1},a.format=b.longDateFormat,a.openDatePicker=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},this.initialize=function(b){d=b,d.$render=e,a.$watchGroup(["date","time"],f)}}]),angular.module("webApp").directive("fwFormInputDateTimePicker",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/common/fw-form-input-date-time-picker.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwImage",function(){"use strict";return{restrict:"E",scope:{id:"@",src:"@"},replace:!0,templateUrl:"modules/common/fw-image.html"}}),angular.module("webApp").controller("fwFormInputHourOfWeekCtrl",["$q","$scope","releaseTimeFormatter",function(a,b,c){"use strict";var d,e=function(a,b){return(a%b+b)%b},f=function(){b.model.day&&b.model.hour?(d.$setViewValue(b.model.day.value+b.model.hour.value),d.$setValidity("hourOfWeek",!0)):(d.$setViewValue(void 0),d.$setValidity("hourOfWeek",!1))},g=function(){var a=0,c=0;if(d.$modelValue){c=d.$modelValue%24;var f=Math.floor(d.$modelValue/24),g=e(f-1,7);a=g}b.model.day=b.model.days[a],b.model.hour=b.model.hours[c]};b.model={days:[{name:"Monday",value:24},{name:"Tuesday",value:48},{name:"Wednesday",value:72},{name:"Thursday",value:96},{name:"Friday",value:120},{name:"Saturday",value:144},{name:"Sunday",value:0}],hours:_.map(_.range(24),function(a){return{name:c.getTimeOfWeek(a),value:a}})},this.initialize=function(a){d=a,d.$render=g,b.$watchGroup(["model.day","model.hour"],f)}}]),angular.module("webApp").directive("fwFormInputHourOfWeek",function(){"use strict";return{restrict:"E",require:["fwFormInputHourOfWeek","ngModel"],controller:"fwFormInputHourOfWeekCtrl",scope:{},templateUrl:"modules/common/fw-form-input-hour-of-week.html",link:function(a,b,c,d){var e=d[0],f=d[1];e.initialize(f)}}}),angular.module("webApp").directive("fwFormCancelButton",["$state",function(a){"use strict";return{restrict:"E",scope:{},replace:!0,templateUrl:"modules/common/fw-form-cancel-button.html",link:function(b){b.cancelForm=function(){a.reload()}}}}]),angular.module("webApp").directive("fwFormDirtyConfirmation",["$state","$modal","uiRouterConstants",function(a,b,c){"use strict";return{restrict:"E",scope:{form:"=",formDirty:"=?"},link:function(d){
if(d.form){d.formDirty||(d.formDirty=function(){return d.form.$dirty}),d.form.discard=function(){d.form.discardChanges=!0},d.form.discardChanges=!1,d.enabled=!0,d.displayed=!1;var e=a.current.name;d.$on(c.stateChangeStartEvent,function(c,f,g){var h=d.enabled&&d.formDirty()&&!d.form.isSubmitting&&!d.form.discardChanges&&f.name!==e;if(h&&(c.preventDefault(),!d.displayed)){d.displayed=!0;var i=b.open({templateUrl:"modules/common/fw-form-dirty-confirmation.html",size:"sm"});i.result.then(function(b){b&&(d.enabled=!1,a.go(f.name,g))})["finally"](function(){d.displayed=!1})}})}}}}]),angular.module("webApp").controller("AccountCtrl",["$scope","$q","accountSettingsRepositoryFactory","accountSettingsStub","errorFacade","blobImageControlFactory",function(a,b,c,d,e,f){"use strict";var g={accountSettings:void 0,errorMessage:void 0},h=c.forCurrentUser(),i=function(){return h.getAccountSettings().then(function(b){g.accountSettings=b,b.profileImage?a.blobImage.update(b.profileImage.containerName,b.profileImage.fileId,!0):a.blobImage.update()})["catch"](function(a){return g.accountSettings=void 0,e.handleError(a,function(a){g.errorMessage=a})})};a.blobImage=f.createControl(),a.model=g,i(),a.onUploadComplete=function(b){g.accountSettings.profileImage=b,a.form.$setDirty(),a.blobImage.update(b.containerName,b.fileId,!1)},a.submitForm=function(){var b,c=h.getUserId();return g.accountSettings.profileImage&&(b=g.accountSettings.profileImage.fileId),d.put(c,{newEmail:g.accountSettings.email,newUsername:g.accountSettings.username,newPassword:g.password?g.password:void 0,newProfileImageId:b}).then(function(){return h.setAccountSettings(g.accountSettings)}).then(function(){a.form.$setPristine()})}}]),angular.module("webApp").constant("accountSettingsRepositoryFactoryConstants",{accountSettingsKey:"accountSettings"}).factory("accountSettingsRepositoryFactory",["$q","masterRepositoryFactory","accountSettingsRepositoryFactoryConstants",function(a,b,c){"use strict";return{forCurrentUser:function(){var a=c.accountSettingsKey,d=b.forCurrentUser(),e={};return e.getUserId=function(){return d.getUserId()},e.getAccountSettings=function(){return d.get(a)},e.setAccountSettings=function(b){return d.set(a,b)},e}}}]),angular.module("webApp").controller("backlogPostListCtrl",function(){"use strict"}),angular.module("webApp").controller("queueReorderCtrl",["$scope","postInteractions",function(a,b){"use strict";a.model={collectionName:"Wallpapers"},a.posts=[{postId:"a",liveIn:"1 day",dayOfWeek:"Wed",date:"21st Jan",comment:"Certain internet providers exploit the fact that fill text cannot be recognized by automatic search engines - meaningful information cannot be distinguished from meaningless: Target-generated dummy text mixed with a certain combination of search terms can lead to an increased frequency of visits by search machine users. As a consequence, advertising revenues, which rely on website hits, are increased.",channel:"HD Channel"},{postId:"b",liveIn:"3 days",dayOfWeek:"Fri",date:"23rd Jan",comment:"Looking good :-)",channel:"Everyone"},{postId:"c",liveIn:"5 days",dayOfWeek:"Sun",date:"25th Jan",comment:"Almost there",collection:"Blog",imagePath:"/static/images/tmp-queue-thumb.55c3fd7.jpg"},{postId:"c",liveIn:"5 days",dayOfWeek:"Sun",date:"25th Jan",collection:"Side Comic",imagePath:"/static/images/tmp-queue-thumb-2.5144bd2.jpg"},{postId:"d",liveIn:"6 days",dayOfWeek:"Mon",date:"26th Jan",comment:"Very nearly there",collection:"Blog",filePath:"/static/images/avatar-default.d97caa7.jpg",fileName:"comic-ebook.pdf"},{postId:"d",liveIn:"6 days",dayOfWeek:"Mon",date:"26th Jan",comment:"Certain internet providers exploit the fact that fill text cannot be recognized by automatic search engines - meaningful information cannot be distinguished from meaningless: Target-generated dummy text mixed with a certain combination of search terms can lead to an increased frequency of visits by search machine users. As a consequence, advertising revenues, which rely on website hits, are increased.",collection:"Blog",filePath:"/static/images/avatar-default.d97caa7.jpg",fileName:"another-comic-ebook.pdf"},{postId:"e",liveIn:"6 days",dayOfWeek:"Mon",date:"26th Jan",collection:"Side Comic",filePath:"/static/images/avatar-default.d97caa7.jpg",fileName:"something-different-ebook.pdf"}],a.viewImage=function(a){b.viewImage(a.image,a.imageSource)},a.editPost=function(a){b.editPost(a)},a.deletePost=function(a){b.deletePost(a)}}]),angular.module("webApp").controller("timelineCtrl",["$scope","$sce","accountSettingsRepositoryFactory","blogRepositoryFactory","channelRepositoryFactory",function(a,b,c,d,e){"use strict";var f=c.forCurrentUser(),g=d.forCurrentUser(),h=e.forCurrentUser();a.model={defaultHeaderImageUrl:"/static/images/header-default.00d41ab.jpg",defaultProfileImageUrl:"/static/images/avatar-default.d97caa7.jpg",tracking:{title:"Subscribed",category:"Timeline"},subscribed:!1},f.getAccountSettings().then(function(b){a.model.accountSettings=b}),g.getBlog().then(function(c){a.model.blog=c,c.video&&(a.model.videoUrl=b.trustAsResourceUrl(c.video.replace("http://","//").replace("https://","//")))}),h.getChannels().then(function(b){a.model.channels=_.chain(b).filter({isVisibleToNonSubscribers:!0}).map(function(a){return{id:a.channelId,name:a.name,price:(a.priceInUsCentsPerWeek/100).toFixed(2),description:a.description.split("\n"),isDefault:a.isDefault,checked:a.isDefault}}).sortByOrder(["isDefault","name"],[!1,!0]).value()}),a.subscribe=function(){a.model.subscribed=!0},a.unsubscribe=function(){a.model.subscribed=!1},a.$watch("model.channels",function(){a.model.totalPrice=_(a.model.channels).filter({checked:!0}).reduce(function(a,b){return a+parseFloat(b.price)},0).toFixed(2)},!0)}]),angular.module("webApp").constant("azureConstants",{timeoutMilliseconds:3e4,checkIntervalMilliseconds:1500}),angular.module("webApp").factory("azureUriService",["$q","$timeout","azureConstants","accessSignatures","azureBlobStub",function(a,b,c,d,e){"use strict";var f={},g=function(a,b){return b?a+"/"+b:a};return f.getBlobUri=function(a,b){return d.getContainerAccessInformation(a).then(function(a){return a.uri+"/"+b+a.signature})},f.tryGetAvailableBlobInformation=function(a,b){return f.getBlobUri(a,b).then(function(a){return e.tryGetAvailableBlobInformation(a)})},f.getAvailableBlobInformation=function(d,e,g){var h=_.now()+c.timeoutMilliseconds,i=function(){return g&&g.isCancelled?a.reject(new CancellationError):_.now()>h?a.reject(new DisplayableError("Timeout","Timed out waiting for blob "+e+" in container "+d+" to be available.")):f.tryGetAvailableBlobInformation(d,e).then(function(a){return a?a:b(i,c.checkIntervalMilliseconds)})};return i()},f.getAvailableImageInformation=function(a,b,c,d){var e=g(b,c);return f.getAvailableBlobInformation(a,e,d)},f.getAvailableFileInformation=function(a,b,c){return f.getAvailableBlobInformation(a,b,c)},f.tryGetAvailableFileInformation=function(a,b){return f.tryGetAvailableBlobInformation(a,b)},f.getImageUri=function(a,b,c){var d=g(b,c);return f.getBlobUri(a,d)},f.getFileUri=function(a,b){return f.getBlobUri(a,b)},f}]),angular.module("webApp").directive("fwAzureImageLoader",["$sce","azureUriService","logService",function(a,b,c){"use strict";return{restrict:"E",scope:{thumbnail:"@",fileId:"@",containerName:"@",outputUrl:"="},replace:!0,link:function(d){var e=function(){b.getImageUri(d.containerName,d.fileId,d.thumbnail).then(function(b){d.outputUrl=a.trustAsResourceUrl(b)})["catch"](function(a){c.error(a)})};d.$watchGroup(["thumbnail","fileId","containerName"],function(){d.thumbnail&&d.fileId&&d.containerName&&e()})}}}]),angular.module("webApp").constant("aggregateUserStateConstants",{updatedEvent:"aggregateUserStateUpdated"}).factory("aggregateUserState",["aggregateUserStateImpl",function(a){"use strict";return a.initialize(),a}]).factory("aggregateUserStateImpl",["$rootScope","localStorageService","aggregateUserStateConstants","fetchAggregateUserStateConstants","authenticationServiceConstants","utilities",function(a,b,c,d,e,f){"use strict";var g="aggregateUserState",h=!1,i=function(){a.$broadcast(c.updatedEvent,m.currentValue)},j=function(a){m.currentValue=a,b.set(g,a),i()},k=function(a,b,c){c=_.cloneDeep(c),delete c.accessSignatures,c.userId=b,j(c)},l=function(a,b){m.currentValue&&b.userId!==m.currentValue.userId&&j(void 0)},m={};return m.currentValue=void 0,m.initialize=function(){if(h)throw new FifthweekError("Aggregate user state already initialized");h=!0,m.currentValue=b.get(g),a.$on(d.fetchedEvent,k),a.$on(e.currentUserChangedEvent,l)},m.setDelta=function(a,b,c){if(m.currentValue&&m.currentValue.userId===a){var d=_.isArray(b)?b:f.getAccessorPathSegments(b);if(0===d.length||0===d[0].length)throw new FifthweekError("Cannot set directly to aggregate root.");var e=_.cloneDeep(m.currentValue),g=f.getValue(e,_.initial(d));if(void 0===g)throw new FifthweekError('Parent object for "'+b+'" does not exist in existing aggregate state');g[_.last(d)]=c,j(e)}},m}]),angular.module("webApp").constant("fetchAggregateUserStateConstants",{fetchedEvent:"aggregateUserStateFetched"}).factory("fetchAggregateUserState",["$q","$rootScope","fetchAggregateUserStateConstants","userStateStub",function(a,b,c,d){"use strict";var e=function(a,d){a===f.lastUserId&&b.$broadcast(c.fetchedEvent,a,d.data)},f={},g={};return g.updateFromServer=function(a){if(f.currentRequest&&f.lastUserId===a)return f.currentRequest;f.lastUserId=a,f.currentRequest=void 0;var b,c=_.curry(e)(a);return b=a?d.getUserState(a).then(c):d.getVisitorState().then(c),f.currentRequest=b,b["finally"](function(){f.currentRequest=void 0}),b},g.updateInParallel=function(b,c){return a.all([c(),g.updateFromServer(b)]).then(function(b){return a.when(b[0])})},g}]),angular.module("webApp").factory("masterRepositoryFactory",["$q","aggregateUserState","authenticationService","utilities",function(a,b,c,d){"use strict";return{forCurrentUser:function(){var e={},f=c.currentUser.userId,g=function(){return!c.currentUser||c.currentUser.userId!==f};return e.getUserId=function(){return f},e.set=function(c,d){if(g())return a.when();if(!b.currentValue)return a.reject(new FifthweekError("No aggregate state found."));var e=_.cloneDeep(d);return b.setDelta(f,c,e),a.when()},e.update=function(c,e){if(g())return a.when();if(!b.currentValue)return a.reject(new FifthweekError("No aggregate state found."));var h=d.getAccessorPathSegments(c),i=d.getValue(b.currentValue,h);if(void 0===i)return a.reject(new FifthweekError('The key "'+c+'" does not match anything within the aggregate user state.'));var j,k=_.cloneDeep(i);try{j=a.when(e(k))}catch(l){j=a.reject(l)}return j.then(function(){b.setDelta(f,c,k)})},e.get=function(c){if(g())return a.reject(new FifthweekError("Repository not valid for current user."));if(!b.currentValue)return a.reject(new FifthweekError("No aggregate state found."));var e=d.getValue(b.currentValue,c);if(void 0===e)return a.reject(new FifthweekError('The key "'+c+'" does not match anything within the aggregate user state.'));var f=_.cloneDeep(e);return a.when(f)},e}}}]),angular.module("webApp").factory("aggregateUserStateUtilities",["aggregateUserState",function(a){"use strict";var b={};return b.getUsername=function(){return a.currentValue&&a.currentValue.accountSettings?a.currentValue.accountSettings.username:void 0},b}]),angular.module("webApp").controller("listChannelsCtrl",["$scope","channelRepositoryFactory","errorFacade",function(a,b,c){"use strict";var d=b.forCurrentUser();a.model={},d.getChannelsSorted().then(function(b){a.model.channels=_.map(b,function(a){return{id:a.channelId,name:a.name,price:(a.priceInUsCentsPerWeek/100).toFixed(2),description:a.description.split("\n"),isDefault:a.isDefault}})})["catch"](function(b){return c.handleError(b,function(b){a.model.errorMessage=b})})}]),angular.module("webApp").controller("editChannelCtrl",["$scope","$q","$state","states","channelRepositoryFactory","channelStub","errorFacade",function(a,b,c,d,e,f,g){"use strict";var h=e.forCurrentUser(),i=c.params.id;a.previousState=d.creators.channels.name,a.model={},h.getChannel(i).then(function(b){a.model.savedChannelName=b.name,a.model.channel=b,a.model.channel.price=(a.model.channel.priceInUsCentsPerWeek/100).toFixed(2),delete a.model.channel.priceInUsCentsPerWeek,a.model.channel.hidden=!a.model.channel.isVisibleToNonSubscribers,delete a.model.channel.isVisibleToNonSubscribers})["catch"](function(b){return g.handleError(b,function(b){a.model.errorMessage=b})}),a.save=function(){var b=a.model.channel,d={name:b.name,description:b.description,price:Math.round(100*b.price),isVisibleToNonSubscribers:!b.hidden};return f.putChannel(i,d).then(function(){return h.updateChannel(i,function(a){a.name=d.name,a.description=d.description,a.priceInUsCentsPerWeek=d.price,a.isVisibleToNonSubscribers=d.isVisibleToNonSubscribers}).then(function(){c.go(a.previousState)})})},a["delete"]=function(){return f.deleteChannel(i).then(function(){return h.deleteChannel(i).then(function(){c.go(a.previousState)})})}}]),angular.module("webApp").controller("newChannelCtrl",["$scope","$q","$state","states","channelRepositoryFactory","channelStub","blogService",function(a,b,c,d,e,f,g){"use strict";var h=e.forCurrentUser();a.model={channel:{name:"",description:"",hidden:!1,price:"1.00"}},a.previousState=d.creators.channels.name,a.create=function(){var b=a.model.channel,d={blogId:g.blogId,name:b.name,description:b.description,price:Math.round(100*b.price),isVisibleToNonSubscribers:!b.hidden};return f.postChannel(d).then(function(b){var e=b.data;return d.collections=[],d.channelId=e,d.priceInUsCentsPerWeek=d.price,d.isDefault=!1,delete d.price,delete d.blogId,h.createChannel(d).then(function(){c.go(a.previousState)})})}}]),angular.module("webApp").directive("fwFormInputChannelName",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/channels/directives/form-input-channel-name.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputChannelDescription",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/channels/directives/form-input-channel-description.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputChannelPrice",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/channels/directives/form-input-channel-price.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputChannelVisibility",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/channels/directives/form-input-channel-visibility.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").factory("channelNameFormatter",function(){"use strict";var a={};return a.shareWith=function(a){return a.isDefault?"Share with everyone":'"'+a.name+'" Only'},a}),angular.module("webApp").factory("channelRepositoryFactory",["$q","masterRepositoryFactory",function(a,b){"use strict";return{forCurrentUser:function(){var c="createdChannelsAndCollections.channels",d=b.forCurrentUser(),e={};return e.getChannels=function(){return d.get(c).then(function(b){return 0===b.length?a.reject(new DisplayableError("You must create a blog.")):a.when(b)})},e.getChannelsSorted=function(){return e.getChannels().then(function(a){return _.sortByOrder(a,["isDefault","name"],[!1,!0])})},e.getChannelMap=function(){return d.get(c).then(function(b){if(0===b.length)return a.reject(new DisplayableError("You must create a blog."));var c=_.reduce(b,function(a,b){return b.collections=_.reduce(b.collections,function(a,b){return a[b.collectionId]=b,a},{}),a[b.channelId]=b,a},{});return a.when(c)})},e.updateChannels=function(b){return d.update(c,function(c){return a.when(b(c))})},e.getChannel=function(b){return e.getChannels().then(function(c){var d=_.find(c,{channelId:b});return d?d:a.reject(new DisplayableError("Channel not found."))})},e.createChannel=function(b){return e.updateChannels(function(c){return _.some(c,{channelId:b.channelId})?a.reject(new DisplayableError("Channel already exists.")):(c.push(b),a.when())})},e.updateChannel=function(b,c){return e.updateChannels(function(d){var e=_.find(d,{channelId:b});return e?a.when(c(e)):a.reject(new DisplayableError("Channel not found."))})},e.deleteChannel=function(b){return e.updateChannels(function(c){return _.remove(c,{channelId:b}),a.when()})},e}}}]),angular.module("webApp").directive("fwFormInputCollectionName",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/collections/directives/form-input-collection-name.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputSelectCollection",function(){"use strict";return{restrict:"E",scope:{items:"=",selectedItem:"=",createNewCollectionDisabled:"=",createNewCollection:"&",id:"@"},templateUrl:"modules/collections/directives/form-input-select-collection.html"}}),angular.module("webApp").controller("listCollectionsCtrl",["$scope","channelRepositoryFactory","errorFacade","releaseTimeFormatter",function(a,b,c,d){"use strict";var e=b.forCurrentUser();a.model={},e.getChannels().then(function(b){a.model.collections=_.chain(b).map(function(a){return _.map(a.collections,function(b){return{id:b.collectionId,name:b.name,channel:a.name,isDefaultChannel:a.isDefault,schedule:d.getDayAndTimesOfWeek(b.weeklyReleaseSchedule)}})}).flatten().sortBy("name").value()})["catch"](function(b){return c.handleError(b,function(b){a.model.errorMessage=b})})}]),angular.module("webApp").controller("editCollectionCtrl",["$scope","$state","states","collectionService","collectionRepositoryFactory","channelRepositoryFactory","channelNameFormatter","releaseTimeFormatter","errorFacade",function(a,b,c,d,e,f,g,h,i){"use strict";var j=b.params.id,k=e.forCurrentUser(),l=f.forCurrentUser(),m=0,n=function(){a.model.schedule=_.sortBy(a.model.schedule,"sortKey")};a.previousState=c.creators.collections.name,a.model={releaseTimesDirty:!1,hourOfWeek:m},l.getChannelsSorted().then(function(b){a.model.channels=_.map(b,function(a){return{value:a.channelId,name:g.shareWith(a)}})}).then(function(){return k.getChannelForCollection(j).then(function(b){var c=_.find(b.collections,{collectionId:j});a.model.savedName=c.name,a.model.name=c.name,a.model.schedule=h.getDayAndTimesOfWeek(c.weeklyReleaseSchedule),a.model.selectedChannel=_.find(a.model.channels,{value:b.channelId}),n()})})["catch"](function(b){return i.handleError(b,function(b){a.model.errorMessage=b})}),a.mainFormDirty=function(){return a.manageCollectionForm.$dirty||a.model.releaseTimesDirty},a.addReleaseTime=function(){a.model.addingReleaseTime=!0,a.model.hourOfWeek=m},a.manageReleaseTime=function(b){a.model.selectedReleaseTime=b,a.model.hourOfWeek=b.hourOfWeek},a.saveReleaseTime=function(){a.model.releaseTimesDirty=!0;var b=h.getDayAndTimeOfWeek(a.model.hourOfWeek);_.merge(a.model.selectedReleaseTime,b),a.model.selectedReleaseTime=null,n()},a.saveNewReleaseTime=function(){a.model.releaseTimesDirty=!0;var b=h.getDayAndTimeOfWeek(a.model.hourOfWeek);a.model.schedule.push(b),a.model.addingReleaseTime=!1,n()},a.save=function(){var c={name:a.model.name,channelId:a.model.selectedChannel.value,weeklyReleaseSchedule:_.pluck(a.model.schedule,"hourOfWeek")};return d.updateCollection(j,c).then(function(){b.go(a.previousState)})},a["delete"]=function(){return d.deleteCollection(j).then(function(){b.go(a.previousState)})},a.deleteReleaseTime=function(){a.model.releaseTimesDirty=!0,_.remove(a.model.schedule,a.model.selectedReleaseTime),a.model.selectedReleaseTime=null}}]),angular.module("webApp").controller("newCollectionCtrl",["$scope","$state","states","channelRepositoryFactory","collectionService","channelNameFormatter","errorFacade",function(a,b,c,d,e,f,g){"use strict";a.previousState=c.creators.collections.name,a.model={collection:{name:""}};var h=d.forCurrentUser();h.getChannelsSorted().then(function(b){a.model.channels=_.map(b,function(a){return{value:a.channelId,name:f.shareWith(a)}}),a.model.selectedChannel=a.model.channels[0]})["catch"](function(b){return g.handleError(b,function(b){a.model.errorMessage=b})}),a.createCollection=function(){var c=a.model.selectedChannel.value,d=a.model.collection.name;return e.createCollectionFromName(c,d).then(function(){b.go(a.previousState)})}}]),angular.module("webApp").factory("collectionRepositoryFactory",["$q","channelRepositoryFactory",function(a,b){"use strict";return{forCurrentUser:function(){var c=b.forCurrentUser(),d={};return d.tryFindChannelForCollection=function(a,b){return _.find(a,function(a){return _.some(a.collections,{collectionId:b})})},d.findChannelForCollection=function(a,b){var c=d.tryFindChannelForCollection(a,b);if(!c)throw new DisplayableError("Channel not found.");return c},d.findChannel=function(a,b){var c=_.find(a,{channelId:b});if(!c)throw new DisplayableError("Channel not found.");return c},d.removeCollectionFromChannels=function(a,b){var c=d.tryFindChannelForCollection(a,b);c&&_.remove(c.collections,{collectionId:b})},d.addCollectionToChannelUnchecked=function(a,b,c){d.findChannel(a,b).collections.push(c)},d.getChannelForCollection=function(b){return c.getChannels().then(function(c){try{return a.when(d.findChannelForCollection(c,b))}catch(e){return a.reject(e)}})},d.createCollection=function(b,e){return c.updateChannels(function(c){if(d.tryFindChannelForCollection(c,e.collectionId))return a.reject(new DisplayableError("Collection already exists."));try{d.addCollectionToChannelUnchecked(c,b,e)}catch(f){return a.reject(f)}return a.when()})},d.updateCollection=function(b,e){return c.updateChannels(function(c){d.removeCollectionFromChannels(c,e.collectionId);try{d.addCollectionToChannelUnchecked(c,b,e)}catch(f){return a.reject(f)}return a.when()})},d.deleteCollection=function(b){return c.updateChannels(function(c){return d.removeCollectionFromChannels(c,b),a.when()})},d}}}]),angular.module("webApp").factory("collectionService",["collectionRepositoryFactory","collectionStub",function(a,b){"use strict";var c={};return c.createCollectionFromName=function(c,d){var e=a.forCurrentUser();return b.postCollection({channelId:c,name:d}).then(function(a){var b={collectionId:a.data.collectionId,name:d,weeklyReleaseSchedule:[a.data.defaultWeeklyReleaseTime]};return e.createCollection(c,b).then(function(){return b.collectionId})})},c.updateCollection=function(c,d){var e=a.forCurrentUser();return b.putCollection(c,d).then(function(){var a=d.channelId,b={collectionId:c,name:d.name,weeklyReleaseSchedule:d.weeklyReleaseSchedule};return e.updateCollection(a,b)})},c.deleteCollection=function(c){var d=a.forCurrentUser();return b.deleteCollection(c).then(function(){return d.deleteCollection(c)})},c}]),angular.module("webApp").factory("releaseTimeFormatter",function(){"use strict";var a={},b=168,c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=function(a,b){return(a%b+b)%b};return a.getDayOfWeek=function(a){if(!_.isNumber(a))throw new FifthweekError("Hour of week must be a number");if(0>a||a>=b)throw new FifthweekError("Hour of week must be between 0 and "+(b-1));return c[Math.floor(a/24)]},a.getDaysOfWeek=function(b){return _.map(b,a.getDayOfWeek)},a.getTimeOfWeek=function(a){var b=a%24+":00";return 4===b.length&&(b="0"+b),b},a.getDayAndTimeOfWeek=function(c){return{day:a.getDayOfWeek(c),time:a.getTimeOfWeek(c),hourOfWeek:c,sortKey:d(c-24,b)}},a.getDayAndTimesOfWeek=function(b){return _.map(b,a.getDayAndTimeOfWeek)},a}),angular.module("webApp").controller("composeOptionsCtrl",["$scope","$modal",function(a,b){"use strict";a.newImage=function(){return b.open({controller:"composeImageCtrl",templateUrl:"modules/creator-compose/compose-upload.html"})},a.newFile=function(){return b.open({controller:"composeFileCtrl",templateUrl:"modules/creator-compose/compose-upload.html"})},a.newAnnouncement=function(){return b.open({controller:"composeNoteCtrl",templateUrl:"modules/creator-compose/compose-note.html"})}}]),angular.module("webApp").directive("fwComposeOptions",function(){"use strict";return{restrict:"E",scope:{},templateUrl:"modules/creator-compose/directives/compose-options.html",controller:"composeOptionsCtrl"}}),angular.module("webApp").factory("composeUtilities",["$q","$modal","channelRepositoryFactory","utilities","logService","collectionStub","collectionService","channelNameFormatter",function(a,b,c,d,e,f,g,h){"use strict";var i={},j=function(a){return _.has(a,"originalName")?a.originalName:a.name},k=function(a,b){var c=j(b);if(a.isDefault)return c;var d=j(a);return c+" ("+d+")"},l=function(a){for(var b=0;b<a.length;++b){var c=a[b];c.originalName=c.name,c.name=h.shareWith(c)}return a},m=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],e=0;e<d.collections.length;++e){var f=d.collections[e];f.originalName=f.name,f.name=k(d,f),b.push(f)}return b};return i.getCollectionNameForSelection=function(a,b){return k(a,b)},i.getChannelsForSelection=function(){var b=c.forCurrentUser();return b.getChannelsSorted().then(function(b){return a.when(l(b))})},i.getCollectionsForSelection=function(){var b=c.forCurrentUser();return b.getChannelsSorted().then(function(b){return a.when(m(b))})},i.getChannelsAndCollectionsForSelection=function(){var b=c.forCurrentUser();return b.getChannelsSorted().then(function(b){return a.when({channels:l(b),collections:m(b)})})},i.loadChannelsAndCollectionsIntoModel=function(a){return i.getChannelsAndCollectionsForSelection().then(function(b){a.collections=b.collections,a.channels=b.channels,a.input.selectedChannel=b.channels[0],a.collections.length>0?(a.input.selectedCollection=a.collections[0],a.createCollection=!1):a.createCollection=!0})["catch"](function(b){e.error(b),a.errorMessage=d.getFriendlyErrorMessage(b)})},i.shouldCreateCollection=function(a){return a.createCollection?!0:a.input.selectedCollection.isNewCollection},i.getCollectionIdAndCreateCollectionIfRequired=function(b){if(i.shouldCreateCollection(b)){var c=b.input.selectedChannel.channelId,d=b.input.newCollectionName;return g.createCollectionFromName(c,d)}return a.when(b.input.selectedCollection.collectionId)},i.showCreateCollectionDialog=function(a){return b.open({controller:"composeCreateCollectionDialogCtrl",templateUrl:"modules/creator-compose/compose-create-collection-dialog.html",scope:a})},i.updateEstimatedLiveDate=function(a){a.queuedLiveDate=void 0,a.input.selectedCollection&&!a.input.selectedCollection.isNewCollection&&f.getLiveDateOfNewQueuedPost(a.input.selectedCollection.collectionId).then(function(b){a.queuedLiveDate=new Date(b.data)})["catch"](function(b){a.queuedLiveDate=void 0,e.error(b),a.errorMessage=d.getFriendlyErrorMessage(b)})},i}]),angular.module("webApp").factory("composeUploadDelegate",["$state","composeUtilities",function(a,b){"use strict";var c={};return c.initialize=function(c,d,e){var f={fileUploaded:!1,postLater:!1,postToQueue:!0,queuedLiveDate:void 0,createCollection:!1,input:{fileId:void 0,comment:"",date:"",newCollectionName:"",selectedCollection:void 0,selectedChannel:void 0},errorMessage:void 0};c.model=f,b.loadChannelsAndCollectionsIntoModel(f),c.onUploadComplete=function(a){f.fileUploaded=!0,f.input.fileId=a.fileId,d&&d(a)};var g,h=function(){a.reload(),c.$close()};c.postLater=function(){f.postLater=!0,b.updateEstimatedLiveDate(f),g=c.$watch("model.input.date",function(a,b){a!==b&&(f.postToQueue=!1)})},c.cancelPostLater=function(){f.postLater=!1,g(),g=void 0},c.createNewCollection=function(){b.showCreateCollectionDialog(c)},c.shouldCreateCollection=function(){return b.shouldCreateCollection(c.model)},c.postNow=function(){return b.getCollectionIdAndCreateCollectionIfRequired(f).then(function(a){var b={collectionId:a,fileId:f.input.fileId,comment:f.input.comment,isQueued:!1};return e(b).then(function(){h()})})},c.postToBacklog=function(){return b.getCollectionIdAndCreateCollectionIfRequired(f).then(function(a){var b={collectionId:a,fileId:f.input.fileId,comment:f.input.comment,isQueued:f.postToQueue,scheduledPostTime:f.postToQueue?void 0:f.input.date};return e(b).then(function(){h()})})}},c}]),angular.module("webApp").controller("composeCreateCollectionDialogCtrl",["$scope","composeUtilities",function(a,b){"use strict";var c=a.model;if(!c)throw new FifthweekError("Scope did not contain any model.");if(!c.collections)throw new FifthweekError("Scope did not contain any collections.");if(!c.channels)throw new FifthweekError("Scope did not contain any channels.");var d=function(){return b.getCollectionNameForSelection(c.input.selectedChannel,{name:c.input.newCollectionName})},e=function(){var a=d();return{isNewCollection:!0,name:a}},f=function(){_.remove(c.collections,"isNewCollection");for(var a=d(),b=0;b<c.collections.length;++b)if(c.collections[b].name===a)return void(c.input.selectedCollection=c.collections[b]);var f=e();c.collections.push(f),c.input.selectedCollection=f};a.submit=function(){f(),a.$close()}}]),angular.module("webApp").controller("composeNoteCtrl",["$scope","$state","postsStub","composeUtilities","utilities","logService",function(a,b,c,d,e,f){"use strict";var g={postLater:!1,input:{note:"",date:""},errorMessage:void 0};a.model=g;var h=function(){return d.getChannelsForSelection().then(function(a){g.channels=a,g.input.selectedChannel=a[0]})["catch"](function(a){f.error(a),g.errorMessage=e.getFriendlyErrorMessage(a)})};h();var i=function(){b.reload(),a.$close()},j=function(a){return c.postNote(a).then(function(){i()})};a.postNow=function(){var a={channelId:g.input.selectedChannel.channelId,note:g.input.note};return j(a)},a.postToBacklog=function(){var a={channelId:g.input.selectedChannel.channelId,note:g.input.note,scheduledPostTime:g.input.date};return j(a)},a.postLater=function(){g.postLater=!0},a.cancelPostLater=function(){g.postLater=!1}}]),angular.module("webApp").controller("composeImageCtrl",["$q","$scope","postsStub","blobImageControlFactory","composeUploadDelegate",function(a,b,c,d,e){"use strict";b.uploadFormFile="image",b.postType="Image",b.blobImage=d.createControl();var f=function(a){b.blobImage.update(a.containerName,a.fileId)};e.initialize(b,f,c.postImage)}]),angular.module("webApp").controller("composeFileCtrl",["$q","$scope","postsStub","composeUploadDelegate",function(a,b,c,d){"use strict";b.uploadFormFile="file",b.postType="File";var e=function(a){b.fileName=a.file.name};d.initialize(b,e,c.postFile)}]),angular.module("webApp").controller("createBlogCtrl",["$scope","$state","calculatedStates","blogService",function(a,b,c,d){"use strict";a.newBlogData={blogName:"",tagline:"",basePrice:"1.00"};var e=function(){var b=_.cloneDeep(a.newBlogData);return b.basePrice=Math.round(100*b.basePrice),b};a["continue"]=function(){return d.createFirstBlog(e()).then(function(){b.go(c.getDefaultState())})}}]),angular.module("webApp").controller("customizeLandingPageCtrl",["$scope","$q","blogRepositoryFactory","aggregateUserStateUtilities","blogStub","errorFacade","blobImageControlFactory",function(a,b,c,d,e,f,g){"use strict";var h={settings:void 0,errorMessage:void 0,landingPageUrl:void 0},i=c.forCurrentUser(),j=function(){return i.getBlog().then(function(b){h.settings=b,h.landingPageUrl="https://www.fifthweek.com/"+d.getUsername(),b.headerImage?a.blobImage.update(b.headerImage.containerName,b.headerImage.fileId,!0):a.blobImage.update()})["catch"](function(a){return h.settings=void 0,f.handleError(a,function(a){h.errorMessage=a})})};a.blobImage=g.createControl(),a.model=h,j(),a.onUploadComplete=function(b){h.settings.headerImage=b,a.form.$setDirty(),a.blobImage.update(b.containerName,b.fileId,!1)},a.submitForm=function(){var b;h.settings.headerImage&&(b=h.settings.headerImage.fileId);var c={blogName:h.settings.blogName,tagline:h.settings.tagline,introduction:h.settings.introduction,headerImageFileId:b,video:h.settings.video?h.settings.video:void 0,description:h.settings.description};return e.putBlog(h.settings.blogId,c).then(function(){
return i.setBlog(h.settings)}).then(function(){a.form.$setPristine()})}}]),angular.module("webApp").controller("fullSizeImageModalCtrl",["$scope","image","imageSource","accessSignatures","postInteractions",function(a,b,c,d,e){"use strict";d.getContainerAccessInformation(b.containerName).then(function(d){a.imagePath=d.uri+"/"+b.fileId+d.signature,a.image=b,a.imageSource=c}),a.openFile=function(a){return e.openFile(a)}}]),angular.module("webApp").factory("postUtilities",["$q","$state","states","accessSignatures",function(a,b,c,d){"use strict";var e={},f=function(a){var b=Math.floor(Math.log(a)/Math.log(1024));return 1*(a/Math.pow(1024,b)).toFixed(2)+" "+["bytes","KB","MB","GB","TB"][b]},g=function(a){return"image/jpeg"===a||"image/gif"===a||"image/png"===a},h=function(a,b,c){var d=a.fileId;b&&(d=d+"/"+b);var e=c[a.containerName];return e.uri+"/"+d+e.signature},i=function(a,b){a.image&&(a.image.resolvedUri=h(a.image,"feed",b)),a.creator.profileImage&&(a.creator.profileImage.resolvedUri=h(a.creator.profileImage,"footer",b))},j=function(a,d,e){a.moment=moment(a.liveDate),a.liveIn=a.moment.fromNow(),delete a.renderSizeRatio,a.imageSource?(a.imageSource.readableSize=f(a.imageSource.size),a.imageSource.viewable=g(a.imageSource.contentType),delete a.fileSource,a.imageSource.viewable||(a.fileSource=a.imageSource),a.imageSource.renderSize&&(a.renderSizeRatio=a.imageSource.renderSize.height/a.imageSource.renderSize.width*100+"%")):a.fileSource&&(a.fileSource.readableSize=f(a.fileSource.size)),a.isScheduled=_.has(a,"scheduledByQueue"),a.isScheduled&&(a.reorder=function(){b.go(c.creators.posts.scheduled.queues.reorder.name,{id:a.collectionId})}),k(a,d),i(a,e)},k=function(a,b){a.dayGrouping=b?!a.moment.isSame(b.moment,"day"):!0},l=function(a,b){var c;_.forEach(a,function(a){j(a,c,b),c=a})};e.populateCurrentCreatorInformation=function(b,c,d){if(!b||0===b.length)return a.when();var e,f;return d.getChannelMap().then(function(a){return e=a,c.getAccountSettings()}).then(function(a){f=a,_.forEach(b,function(a){a.channel=e[a.channelId],a.collectionId&&(a.collection=a.channel.collections[a.collectionId]),a.creator={username:f.username,profileImage:f.profileImage}})})},e.processPostsForRendering=function(b){return b&&0!==b.length?d.getContainerAccessMap().then(function(a){l(b,a)}):a.when()},e.processPostForRendering=function(a){return d.getContainerAccessMap().then(function(b){j(a,void 0,b)})},e.removePost=function(b,c){if(!b||0===b.length)return a.when();for(var d=0;d<b.length;++d)if(b[d].postId===c)return b.splice(d,1),b.length>d&&k(b[d],0===d?void 0:b[d-1]),a.when()};var m=function(a,b){return a.moment.isBefore(b.moment)},n=function(a,b){return a.moment.isAfter(b.moment)||a.moment.isSame(b.moment)};return e.replacePostAndReorderIfRequired=function(a,b,c,d){var f=!1;if(f=a?!d.isScheduled:d.isScheduled)return void e.removePost(b,d.postId);if(1===b.length||c.isSame(d.moment)){var g=_.findIndex(b,{postId:d.postId});return void(-1!==g&&(d.dayGrouping=b[g].dayGrouping,b[g]=d))}var h=n;a&&(h=m),e.removePost(b,d.postId);for(var i=0;i<b.length;++i)if(h(d,b[i]))return b.splice(i,0,d),k(b[i],0===i?void 0:b[i-1]),void k(b[i+1],b[i]);b.push(d),k(b[b.length-1],b[b.length-2])},e}]),angular.module("webApp").factory("postInteractions",["$q","$modal","accessSignatures","postsStub",function(a,b,c,d){"use strict";var e={};return e.viewImage=function(a,c){b.open({controller:"fullSizeImageModalCtrl",templateUrl:"modules/posts/full-size-image-modal.html",windowClass:"modal-fw-large-image",resolve:{image:function(){return a},imageSource:function(){return c}}})},e.openFile=function(a){return c.getContainerAccessInformation(a.containerName).then(function(b){var c=b.uri+"/"+a.fileId+b.signature;window.open(c,"_blank")})},e.editPost=function(a){return b.open({controller:"postEditDialogCtrl",templateUrl:"modules/posts/post-edit-dialog.html",resolve:{post:function(){return a}}})},e.deletePost=function(a){return d.deletePost(a)},e}]),angular.module("webApp").constant("fwPostListConstants",{sources:{creatorBacklog:"creator-backlog",creatorTimeline:"creator-timeline",creatorPosts:"creator-posts"}}).directive("fwPostList",["fwPostListConstants","fifthweekConstants",function(a,b){"use strict";return{restrict:"E",scope:{source:"@"},require:["fwPostList"],templateUrl:"modules/posts/fw-post-list.html",controller:"fwPostListCtrl",link:function(c,d,e,f){c.fifthweekConstants=b,c.sourceName=_.startCase(c.source),c.sources=a.sources;var g=f[0];g.initialize()}}}]),angular.module("webApp").controller("fwPostListCtrl",["$scope","$q","fwPostListConstants","postInteractions","authenticationService","channelRepositoryFactory","accountSettingsRepositoryFactory","fetchAggregateUserState","postsStub","errorFacade","postUtilities",function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l,m,n,o={posts:void 0,isLoading:!1,errorMessage:void 0},p=function(){return b.reject(new DisplayableError("Unknown fw-post-list source."))},q=function(){o.errorMessage=void 0,o.isLoading=!0;var a,b=function(){return p(0,1e3)};h.updateInParallel(n,b).then(function(b){return a=b.data,k.populateCurrentCreatorInformation(a,l,m)}).then(function(){return k.processPostsForRendering(a)}).then(function(){o.posts=a})["catch"](function(a){return o.posts=void 0,j.handleError(a,function(a){o.errorMessage=a})})["finally"](function(){o.isLoading=!1})};a.model=o,a.viewImage=function(a,b){d.viewImage(a,b)},a.openFile=function(a){return d.openFile(a)},a.editPost=function(b){var e=d.editPost(b);e.result.then(function(d){if(d){var e=a.source===c.sources.creatorBacklog;k.replacePostAndReorderIfRequired(e,o.posts,b.moment,d)}})},a.deletePost=function(a){return d.deletePost(a).then(function(){k.removePost(o.posts,a)})},this.initialize=function(){l=g.forCurrentUser(),m=f.forCurrentUser(),n=e.currentUser.userId,a.source===c.sources.creatorBacklog?p=function(){return i.getCreatorBacklog(n)}:(a.source===c.sources.creatorTimeline||a.source===c.sources.creatorPosts)&&(p=function(a,b){return i.getCreatorNewsfeed(n,a,b)}),q()}}]),angular.module("webApp").constant("postEditDialogConstants",{postTypes:{image:"image",file:"file",note:"note"},scheduleModes:{now:0,scheduled:1,queued:2}}).controller("postEditDialogCtrl",["$scope","$q","post","postEditDialogConstants","composeUtilities","blobImageControlFactory","postEditDialogUtilities",function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){return a===b||a-b===0};c=_.cloneDeep(c),delete c.moment;var i=d.postTypes,j=d.scheduleModes,k=j.now;c.isScheduled&&(k=c.scheduledByQueue?j.queued:j.scheduled);var l=new Date(c.liveDate),m=new Date(c.liveDate);m.setUTCSeconds(0,0);var n={savedScheduleMode:k,savedDate:l,queuedLiveDate:void 0,input:{comment:c.comment,image:c.image,imageSource:c.imageSource,file:c.file,fileSource:c.fileSource,date:m,scheduleMode:k}};a.model=n,a.postTypes=i,a.scheduleModes=j,a.blobImage=f.createControl(),n.postType=c.image?i.image:c.file?i.file:i.note,a.onUploadComplete=function(b){var c=g.getFileInformation(b);n.postType===i.file?(n.input.file=c.file,n.input.fileSource=c.fileSource):n.postType===i.image&&(n.input.image=c.file,n.input.imageSource=c.fileSource,a.blobImage.update(b.containerName,b.fileId))},a.$watch("model.input.date",function(a,b){h(a,b)||(n.input.scheduleMode=j.scheduled)}),e.loadChannelsAndCollectionsIntoModel(n).then(function(){n.input.selectedChannel=_.find(n.channels,{channelId:c.channel.channelId}),n.postType!==i.note&&(n.input.selectedCollection=_.find(n.collections,{collectionId:c.collection.collectionId}),a.$watch("model.input.selectedCollection",function(){return e.updateEstimatedLiveDate(n)}))}),a.save=function(){return g.performSave(c.postId,n).then(function(){return g.applyChangesToPost(c,n)}).then(function(){a.$close(c)})}}]),angular.module("webApp").factory("postEditDialogUtilities",["$q","postEditDialogConstants","postsStub","postUtilities",function(a,b,c,d){"use strict";var e=b.postTypes,f=b.scheduleModes,g={};g.internal={};var h=function(a,b){return a===b||a-b===0},i=function(a){return a.replace(/^.*[\\\/]/,"")},j=function(a){return a.split(".").pop()},k=function(a,b){return a.substring(0,a.length-b.length-1)},l=function(a){return a.input.scheduleMode!==a.savedScheduleMode?!0:a.input.scheduleMode===f.scheduled?!h(a.savedDate,a.input.date):!1};return g.internal.saveContent=function(b,d){return d.postType===e.note?c.putNote(b,{channelId:d.input.selectedChannel.channelId,note:d.input.comment}):d.postType===e.file?c.putFile(b,{fileId:d.input.file.fileId,comment:d.input.comment}):d.postType===e.image?c.putImage(b,{imageFileId:d.input.image.fileId,comment:d.input.comment}):a.when()},g.internal.saveSchedule=function(b,d){if(l(d)){if(d.input.scheduleMode===f.now)return c.postToLive(b);if(d.input.scheduleMode===f.queued)return c.postToQueue(b);if(d.input.scheduleMode===f.scheduled)return c.putLiveDate(b,d.input.date)}return a.when()},g.getFileInformation=function(a){var b=i(a.file.name),c=j(b),d=k(b,c);return{file:{fileId:a.fileId,containerName:a.containerName},fileSource:{fileName:d,fileExtension:c,contentType:a.file.type,size:a.file.size}}},g.performSave=function(a,b){return g.internal.saveContent(a,b).then(function(){return g.internal.saveSchedule(a,b)})},g.applyChangesToPost=function(a,b){if(a.channelId=b.input.selectedChannel.channelId,b.postType!==e.note&&(a.collectionId=b.input.selectedCollection.collectionId),a.comment=b.input.comment,a.file=b.input.file,a.fileSource=b.input.fileSource,a.image=b.input.image,a.imageSource=b.input.imageSource,l(b))if(b.input.scheduleMode===f.now)delete a.scheduledByQueue,a.liveDate=(new Date).toISOString();else if(b.input.scheduleMode===f.queued)a.scheduledByQueue=!0,a.liveDate=b.queuedLiveDate.toISOString();else if(b.input.scheduleMode===f.scheduled){var c=moment();c.isBefore(b.input.date)?a.scheduledByQueue=!1:delete a.scheduledByQueue,a.liveDate=b.input.date.toISOString()}return d.processPostForRendering(a)},g}]),angular.module("webApp").constant("blogRepositoryFactoryConstants",{blogKey:"blog"}).factory("blogRepositoryFactory",["$q","masterRepositoryFactory","blogRepositoryFactoryConstants",function(a,b,c){"use strict";return{forCurrentUser:function(){var d=c.blogKey,e=b.forCurrentUser(),f={};return f.getUserId=function(){return e.getUserId()},f.getBlog=function(){return e.get(d).then(function(b){return b?a.when(b):a.reject(new DisplayableError("You do not have a blog."))})},f.setBlog=function(a){return e.set(d,a)},f}}}]),angular.module("webApp").constant("blogServiceConstants",{defaultChannelName:"Basic Subscription",defaultChannelDescription:"Exclusive News Feed\nEarly Updates on New Releases",defaultBlogIntroduction:"Welcome to my new exclusive series. More of your favourites released every week, available to subscribers only."}).factory("blogService",["$rootScope","$q","blogStub","aggregateUserState","authenticationService","blogRepositoryFactory","blogServiceConstants",function(a,b,c,d,e,f,g){"use strict";var h=Object.create({},{blogId:{get:function(){return d.currentValue&&d.currentValue.creatorStatus?d.currentValue.creatorStatus.blogId:null}},hasBlog:{get:function(){return null!==h.blogId}}});return h.createFirstBlog=function(a){if(h.hasBlog)return b.reject(new FifthweekError("Blog already created"));var i=e.currentUser.userId,j=f.forCurrentUser();return c.postBlog(a).then(function(b){var c=b.data,e=[{channelId:c,priceInUsCentsPerWeek:a.basePrice,isDefault:!0,isVisibleToNonSubscribers:!0,collections:[],name:g.defaultChannelName,description:g.defaultChannelDescription}];d.setDelta(i,"creatorStatus",{blogId:c}),d.setDelta(i,"createdChannelsAndCollections",{channels:e});var f=_.cloneDeep(a);return f.blogId=c,f.creatorId=i,delete f.basePrice,f.introduction=g.defaultBlogIntroduction,f.creationDate=new Date,j.setBlog(f)})},h}]),angular.module("webApp").directive("fwFormInputBlogName",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/blog/directives/form-input-blog-name.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputTagline",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"modules/blog/directives/form-input-tagline.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").controller("SignInCtrl",["$scope","$state","calculatedStates","authenticationService",function(a,b,c,d){"use strict";a.signInData={username:"",password:""},a.signIn=function(){return d.signIn(a.signInData).then(function(){b.go(c.getDefaultState())})}}]),angular.module("webApp").controller("SignInForgotCtrl",["$q","$scope","membershipStub",function(a,b,c){"use strict";b.passwordResetRequestData={username:"",email:""},b.requestPasswordReset=function(){return c.postPasswordResetRequest(b.passwordResetRequestData)}}]),angular.module("webApp").controller("SignInResetCtrl",["$scope","$state","membershipStub","errorFacade",function(a,b,c,d){"use strict";var e=b.params.userId,f=b.params.token;return a.passwordResetConfirmationData={newPassword:"",userId:e,token:f},void 0===e||void 0===f?void(a.tokenInvalid=!0):(a.tokenInvalid=!1,a.confirmPasswordReset=function(){return c.postPasswordResetConfirmation(a.passwordResetConfirmationData)},void c.getPasswordResetTokenValidity(e,f)["catch"](function(b){return b instanceof ApiError&&404===b.response.status?void(a.tokenInvalid=!0):d.handleError(b,function(b){a.form.message=b})}))}]),angular.module("webApp").controller("HomeCtrl",["$scope","$state","calculatedStates","$modal","authenticationService",function(a,b,c,d,e){"use strict";a.registrationSucceeded=!1,a.registrationData={email:"",username:"",password:""},a.register=function(){return e.registerUser(a.registrationData).then(function(){a.registrationSucceeded=!0,a.form.message="Signing in...";var d={username:a.registrationData.username,password:a.registrationData.password};return e.signIn(d).then(function(){b.go(c.getDefaultState())})})},a.openModal=function(){d.open({templateUrl:"views/home-modal.html",size:"lg"})}}]),angular.module("webApp").controller("HeaderCtrl",["$scope","navigationOrchestrator","navigationOrchestratorConstants",function(a,b,c){"use strict";a.$on(c.navigationChangedEvent,function(b,c,d){a.navigation=d}),a.navigation=b.getSecondaryNavigation()}]),angular.module("webApp").controller("SidebarCtrl",["$scope","navigationOrchestrator","navigationOrchestratorConstants",function(a,b,c){"use strict";a.$on(c.navigationChangedEvent,function(b,c){a.navigation=c}),a.navigation=b.getPrimaryNavigation()}]),angular.module("webApp").controller("deleteLinkCtrl",["$scope","deleteVerification",function(a,b){"use strict";a.verifyDelete=function(){b.verifyDelete(a["delete"],a.eventTitle,a.eventCategory,a.itemType,a.item)}}]),angular.module("webApp").controller("deleteVerificationCtrl",["$q","$scope","deleteContext",function(a,b,c){"use strict";b.model={confirmationText:"",itemTypeLowered:c.itemType.toLowerCase()},_.merge(b.model,c),b.confirmDelete=function(){return a.when(c.action()).then(function(){b.$close()})}}]),angular.module("webApp").controller("fileUploadCtrl",["$scope","$q","fileUploadStub","azureBlobUpload","utilities","logService",function(a,b,c,d,e,f){"use strict";var g=function(c){try{var d=a.onUploadComplete;return _.isFunction(d)&&d({data:c}),b.when()}catch(e){return f.error(e),b.when()}},h=function(b){a.model.progress=Math.round(b)},i=function(b){a.model.errorMessage=b},j=function(b){a.model.isSubmitting=b},k=function(b){if(a.accept){var c=a.accept.split(/[\s,]+/);return _.includes(c,b.type)}return!0},l=function(c){if(!a.filePurpose)return b.reject(new InputValidationError("No file purpose specified."));if(!c||!c.length)return b.reject(new InputValidationError("No files selected."));var d=c[0];return k(d)?b.when(d):b.reject(new InputValidationError("The selected file type is not supported."))},m=function(b){var e;return c.postUploadRequest({filePath:b.name,purpose:a.filePurpose}).then(function(a){return e=a.data,d.upload({uri:e.accessInformation.uri,signature:e.accessInformation.signature,file:b,progress:h})}).then(function(){return c.postUploadCompleteNotification(e.fileId)}).then(function(){return g({file:b,fileId:e.fileId,uri:e.accessInformation.uri,containerName:e.accessInformation.containerName})})},n=window.File&&window.FileReader&&window.FileList&&window.Blob;a.model={fileApiSupported:n},a.upload=function(a){return h(0),i(""),j(!0),l(a).then(function(a){return m(a)})["catch"](function(a){return i(e.getFriendlyErrorMessage(a)),f.error(a),b.when()})["finally"](function(){j(!1)})}}]),angular.module("webApp").controller("formSubsectionCtrl",["$q","$scope",function(a,b){"use strict";b.formSubsection={expanded:!1}}]),angular.module("webApp").controller("SignOutCtrl",["$state","states","authenticationService",function(a,b,c){"use strict";c.signOut(),a.go(b.signIn.name,{},{location:"replace"})}]),angular.module("webApp").constant("blobImageCtrlConstants",{initialWaitMilliseconds:3e3,updateEvent:"update"}).controller("blobImageCtrl",["$scope","$q","$timeout","blobImageCtrlConstants","azureUriService","errorFacade",function(a,b,c,d,e,f){"use strict";a.model={imageUri:void 0,renderSize:void 0,errorMessage:void 0,updating:!1};var g,h=function(h,i,j,k,l){if(a.model.errorMessage=void 0,a.model.imageUri=void 0,g&&(g.isCancelled=!0,g=void 0),!j)return a.model.updating=!1,b.when();g={},a.model.updating=!0;var m,n=function(){return e.getAvailableImageInformation(i,j,k,g)};m=l?n():c(n,d.initialWaitMilliseconds),m.then(function(b){a.model.imageUri=b.uri,a.model.renderSize=void 0,b.width&&b.height&&(a.model.renderSize={width:b.width/2+"px",height:b.height/2+"px"}),a.model.updating=!1})["catch"](function(b){return f.handleError(b,function(b){a.model.errorMessage=b,a.model.updating=!1})})};a.$on(d.updateEvent,h)}]),angular.module("webApp").directive("money",function(){"use strict";function a(a,c,d,e){function f(a){var b=Math.pow(10,k);return Math.round(a*b)/b}function g(a){return parseFloat(a).toFixed(k)}function h(a){return e.$isEmpty(a)?"":""+a}var i,j=parseFloat(d.min||0),k=parseFloat(d.precision||2);e.$parsers.push(function(a){angular.isUndefined(a)&&(a=""),0===a.indexOf(".")&&(a="0"+a),0===a.indexOf("-")&&(j>=0?(a=null,e.$setViewValue(""),e.$render()):"-"===a&&(a=""));var c=e.$isEmpty(a);return c||b.test(a)?i=""===a?null:c?a:parseFloat(a):(e.$setViewValue(h(i)),e.$render()),e.$setValidity("number",!0),i}),e.$formatters.push(h);var l=function(a){return!e.$isEmpty(a)&&j>a?void e.$setValidity("min",!1):(e.$setValidity("min",!0),a)};if(e.$parsers.push(l),e.$formatters.push(l),d.max){var m=parseFloat(d.max),n=function(a){return!e.$isEmpty(a)&&a>m?void e.$setValidity("max",!1):(e.$setValidity("max",!0),a)};e.$parsers.push(n),e.$formatters.push(n)}k>-1&&(e.$parsers.push(function(a){return a?f(a):a}),e.$formatters.push(function(a){return a?g(a):a})),c.bind("blur",function(){var a=e.$modelValue;a&&(e.$viewValue=g(a),e.$render())})}var b=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;return{restrict:"A",require:"ngModel",link:a}}),angular.module("webApp").config(["$provide",function(a){"use strict";a.decorator("ngTranscludeDirective",["$delegate",function(a){return a.shift(),a}])}]).directive("ngTransclude",function(){"use strict";return{restrict:"EAC",link:function(a,b,c,d,e){if(!e)throw new FifthweekError("Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. ");var f=c.ngTransclude||"sibling";switch(f){case"sibling":e(function(a){b.empty(),b.append(a)});break;case"parent":e(a,function(a){b.empty(),b.append(a)});break;case"child":var g=a.$new();e(g,function(a){b.empty(),b.append(a),b.on("$destroy",function(){g.$destroy()})})}}}}),angular.module("webApp").directive("fwRoles",["authorizationService","authorizationServiceConstants",function(a,b){"use strict";return{restrict:"A",link:function(c,d,e){var f=function(){d.removeClass("hidden")},g=function(){d.addClass("hidden")},h=function(c){var d;c&&f(),d=a.authorize(!0,i,e.fwRoleCheckType),d===b.authorizationResult.authorized?f():g()},i=e.fwRoles.split(/[\s,]+/);i.length>0&&h(!0)}}}]),angular.module("webApp").directive("fwBreadcrumb",["navigationOrchestrator",function(a){"use strict";return{restrict:"E",scope:{intermediateStates:"&",current:"@",previous:"@",previousState:"&"},templateUrl:"views/partials/breadcrumb.html",link:{pre:function(b,c,d){var e=_.find(a.getSecondaryNavigation(),{isActive:!0})||_.find(a.getPrimaryNavigation(),{isActive:!0});if(!e)throw new FifthweekError("Could not determine active secondary page for breadcrumb");b.rootName=e.name,b.rootIcon=e.icon,b.rootState=e.state,b.intermediateStates=d.previous&&d.previousState?[{name:b.previous,click:b.previousState}]:b.intermediateStates()}}}}]),angular.module("webApp").directive("fwCol7",function(){"use strict";return{restrict:"E",transclude:!0,template:'<div class="row"><div class="col-ss-offset-1 col-ss-10 col-s-offset-0 col-s-8 col-sm-7"><ng-transclude></ng-transclude></div></div>'}}),angular.module("webApp").directive("fwCheckUsernameAvailability",["$q","membershipStub","logService",function(a,b,c){"use strict";return{require:"ngModel",link:function(d,e,f,g){var h;g.$asyncValidators.username=function(d){if(g.$pristine)return h=d,a.when();if(d===h)return a.when();if(g.$isEmpty(d))return a.when();var e=a.defer();return b.getUsernameAvailability(d).then(function(){e.resolve()})["catch"](function(a){a instanceof ApiError&&404===a.response.status?e.reject():(c.error(a),e.resolve())}),e.promise}}}}]),angular.module("webApp").directive("fwDeleteLink",function(){"use strict";return{restrict:"E",transclude:!0,scope:{"class":"@",linkId:"@",itemType:"@",item:"=",eventTitle:"@",eventCategory:"@","delete":"&"},templateUrl:"views/partials/delete-link.html"}}),angular.module("webApp").directive("fwFormGroup",function(){"use strict";return{restrict:"E",transclude:!0,replace:!0,scope:!0,require:"^form",templateUrl:"views/partials/form-group.html",link:{pre:function(a,b,c,d){var e=c.inputName,f=d.$name;a.form=d,a.getInputName=function(){if(!e){var a=b.find("input");0===a.length&&(a=b.find("textarea")),e=a.attr("name")}return e},a.getFormName=function(){return f}},post:function(a){var b=a.getFormName(),c=a.getInputName();if(void 0===b)throw new FifthweekError("Outer form must exist with name attribute defined");if(void 0===c)throw new FifthweekError("Inner input must exist with name attribute defined");a.input=a[b][c],a.form=a[b]}}}}),angular.module("webApp").directive("fwFormInputComment",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"views/partials/form-input-comment.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputDelete",function(){"use strict";return{restrict:"E",scope:{linkId:"@",itemType:"@",item:"=",dataEventTitle:"@",dataEventCategory:"@","delete":"&"},templateUrl:"views/partials/form-input-delete.html"}}),angular.module("webApp").directive("fwFormInputGlyphs",["$compile",function(a){"use strict";return{restrict:"A",link:function(b,c){c.addClass("has-feedback");var d='<span fw-form-input-valid class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>',e=angular.element(d);c.append(e),a(e)(b);var f='<span fw-form-input-invalid class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>',g=angular.element(f);c.append(g),a(g)(b)}}}]),angular.module("webApp").directive("fwFormInputInvalid",["$compile",function(a){"use strict";return{restrict:"A",terminal:!0,priority:1e3,link:function(b,c,d){var e=b.getFormName(),f=b.getInputName(),g=d.fwFormInputInvalid;f=e+"."+f;var h;h=g?f+".$error."+g+" && (("+f+".$touched && "+f+".$dirty) || "+e+".$submitted)":f+".$invalid && (("+f+".$touched && "+f+".$dirty) || "+e+".$submitted)",c.removeAttr("fw-form-input-invalid"),c.attr("ng-if",h),a(c)(b)}}}]),angular.module("webApp").directive("fwFormInputInvalidP",["$compile",function(a){"use strict";return{restrict:"A",terminal:!0,priority:1e3,link:function(b,c,d){var e=d.fwFormInputInvalidP;c.removeAttr("fw-form-input-invalid-p"),c.attr("fw-form-input-invalid",e),c.addClass("help-block"),a(c)(b)}}}]),angular.module("webApp").directive("fwFormInputNote",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"views/partials/form-input-note.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputSelect",function(){"use strict";return{restrict:"E",scope:{items:"=",selectedItem:"=",ngDisabled:"@",inputId:"@"},templateUrl:"views/partials/form-input-select.html"}}),angular.module("webApp").directive("fwFormInputValid",["$compile",function(a){"use strict";return{restrict:"A",terminal:!0,priority:1e3,link:function(b,c){var d=b.getFormName(),e=b.getInputName();e=d+"."+e;var f=e+".$valid && (("+e+".$touched && "+e+".$dirty) || "+d+".$submitted)";c.removeAttr("fw-form-input-valid"),c.attr("ng-if",f),a(c)(b)}}}]),angular.module("webApp").directive("fwMarkdown",function(){return{restrict:"EA",require:"?ngModel",scope:{replace:"@"},link:function(a,b,c,d){if(!d){var e=marked(b.text());return void(a.replace?b.replaceWith(e):b.html(e))}d.$render=function(){var c=marked(d.$viewValue||"");a.replace?b.replaceWith(c):b.html(c)}}}}),angular.module("webApp").directive("fwFormInputPassword",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"views/partials/form-input-password.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormInputUsername",["utilities",function(a){"use strict";return{restrict:"E",scope:!0,templateUrl:"views/partials/form-input-username.html",link:function(b,c,d){a.forDirective(b,c,d).scaffoldFormInput()}}}]),angular.module("webApp").directive("fwFormModal",function(){"use strict";return{restrict:"E",scope:!0,templateUrl:function(a){return a.data("form-body",a.find("form-body")),a.data("form-buttons",a.find("form-buttons")),"views/partials/form-modal.html"},compile:function(a){return a.find("form-body-placeholder").replaceWith(a.data("form-body").contents()),a.find("form-buttons-placeholder").replaceWith(a.data("form-buttons").contents()),{pre:function(a,b,c){a.name=c.name,a.idPrefix=c.idPrefix||"modal"}}}}}),angular.module("webApp").directive("fwFormModalTitle",function(){"use strict";return{restrict:"E",scope:!0,templateUrl:"views/partials/form-modal-title.html",link:function(a,b,c){a.name=c.name,a.idPrefix=c.idPrefix||"modal"}}}),angular.module("webApp").directive("fwFormSubmit",["$q","wrapUserAction",function(a,b){"use strict";return{restrict:"A",require:"^form",scope:{canSubmit:"&",fwFormSubmit:"&"},link:function(c,d,e,f){var g=e.canSubmit?c.canSubmit:null,h=c.fwFormSubmit;if(void 0===f)throw new FifthweekError("Must be within a form");g||(g=function(){return f.$valid&&f.$dirty}),f.isSubmitting=!1,f.hasAttemptedSubmit=!1,f.hasSubmitted=!1,f.submissionSucceeded=!1,f.message="",d.bind("click",function(){if(f.hasAttemptedSubmit=!0,!g())return a.when();f.isSubmitting=!0,f.submissionSucceeded=!1,f.message="",e.hasOwnProperty("ngDisabled")||d.addClass("disabled").attr("disabled","disabled");var c=d.data("loading-text");c&&(d.data("resetText",d.html()),d.html(c));var i={eventTitle:d.data("event-title"),eventCategory:d.data("event-category")};return b(h,i).then(function(a){a?f.message=a:f.submissionSucceeded=!0,f.hasSubmitted=!0,f.isSubmitting=!1,e.hasOwnProperty("ngDisabled")||d.removeClass("disabled").removeAttr("disabled");var b=d.data("resetText");b&&d.html(b)})})}}}]),angular.module("webApp").directive("fwFormSubsection",function(){"use strict";return{restrict:"E",scope:!0,replace:!0,templateUrl:function(a){return a.data("summary",a.find("summary")),a.data("summary-expanded",a.find("summary-expanded")),a.data("section",a.find("section")),"views/partials/form-subsection.html"},compile:function(a){a.find("summary-placeholder").replaceWith(a.data("summary").contents()),a.find("section-placeholder").replaceWith(a.data("section").contents());var b=a.data("summary-expanded"),c=1===b.length;return c&&a.find("summary-expanded-placeholder").replaceWith(a.data("summary-expanded").contents()),{pre:function(a,b,d){a.name=d.name,a.hasExpandedSummary=c}}}}}),angular.module("webApp").directive("fwManagedList",function(){"use strict";return{restrict:"E",transclude:!0,scope:{itemName:"@",items:"=",newItemState:"@",manageItemState:"@"},templateUrl:"views/partials/managed-list.html"}}),angular.module("webApp").directive("fwManagedListSm",function(){"use strict";return{restrict:"E",transclude:!0,replace:!0,scope:{itemName:"@",items:"=",newItem:"&",manageItem:"&"},templateUrl:"views/partials/managed-list-sm.html"}}),angular.module("webApp").directive("fwPanel6",function(){"use strict";return{restrict:"E",transclude:!0,template:'<div class="row"><div class="col-ss-offset-1 col-ss-10 col-s-offset-0 col-s-8 col-sm-7"><div class="panel panel-default"><div class="panel-body jumbo-panel"><ng-transclude></ng-transclude></div></div></div></div>'}}),angular.module("webApp").directive("fwPanel12",function(){"use strict";return{restrict:"E",transclude:!0,template:'<div class="row"><div class="col-xs-12"><div class="panel panel-default"><div class="panel-body jumbo-panel"><ng-transclude></ng-transclude></div></div></div></div>'}}),angular.module("webApp").directive("fwSetNavigationVisibilityFromState",["$state","uiRouterConstants",function(a,b){"use strict";return{restrict:"A",link:function(c,d){var e=function(a){a.data&&a.data.navigationHidden?d.addClass("navigation-hidden"):d.removeClass("navigation-hidden")};e(a.current),c.$on(b.stateChangeSuccessEvent,function(a,b){e(b)})}}}]),angular.module("webApp").directive("fwAssignCssClassFromState",["$state","uiRouterConstants",function(a,b){"use strict";return{restrict:"A",link:function(c,d){var e=function(a){a.data&&a.data.bodyClass&&d.addClass(a.data.bodyClass)},f=function(a){a.data&&a.data.bodyClass&&d.removeClass(a.data.bodyClass)};e(a.current),c.$on(b.stateChangeSuccessEvent,function(a,b,c,d){f(d),e(b)})}}}]),angular.module("webApp").directive("fwFileUpload",function(){"use strict";return{scope:{onUploadComplete:"&",description:"@",abbreviateProgress:"@",filePurpose:"@",accept:"@"},templateUrl:"views/partials/file-upload.html"}}),angular.module("webApp").directive("fwFileInputOnChange",function(){"use strict";return{restrict:"A",scope:{fwFileInputOnChange:"&"},link:function(a,b){b.on("change",function(c){a.fwFileInputOnChange({files:c.target.files}),b.attr("value","")})}}}),angular.module("webApp").directive("fwBlobImage",["blobImageCtrlConstants",function(a){"use strict";return{scope:{control:"=",thumbnail:"@",fileId:"@",containerName:"@"},templateUrl:"views/partials/blob-image.html",link:function(b){var c=function(c,d,e){return d?void b.$broadcast(a.updateEvent,c,d,b.thumbnail,e):void b.$broadcast(a.updateEvent)};b.control&&b.control.initialize(c),b.fileId&&b.containerName&&c(b.containerName,b.fileId,!0)}}}]),angular.module("webApp").directive("fwErrorMessage",function(){"use strict";return{scope:{value:"=","class":"@"},templateUrl:"views/partials/error-message.html"}}),angular.module("webApp").directive("vimeoVideo",["analytics",function(a){"use strict";return{link:function(b,c,d){var e=$f(c[0]);c.load(function(){e.addEvent("ready",function(){e.addEvent("play",function(){a.eventTrack('Played video "'+d.title+'"',"Video")}),e.addEvent("pause",function(){a.eventTrack('Paused video "'+d.title+'"',"Video")}),e.addEvent("finish",function(){a.eventTrack('Finished video "'+d.title+'"',"Video")})})})}}}]),angular.module("webApp").constant("accessSignaturesConstants",{publicContainerName:"public"}).factory("accessSignatures",["$q","accessSignaturesCache","accessSignaturesConstants",function(a,b,c){"use strict";var d={};return d.getPublicAccessInformation=function(){return b.getSignatures().then(function(b){return a.when(b.publicSignature)})},d.getCreatorAccessInformation=function(c){return b.getSignatures().then(function(b){
if(c){var d=b.privateSignatures;if(d)for(var e=0;e<d.length;e++)if(d[e].creatorId===c)return a.when(d[e].information);return a.reject(new FifthweekError("No shared access signatures found for creator: "+c))}return a.when(b.publicSignature)})},d.getContainerAccessInformation=function(d){return b.getSignatures().then(function(b){if(d&&d!==c.publicContainerName){var e=b.privateSignatures;if(e)for(var f=0;f<e.length;f++)if(e[f].information.containerName===d)return a.when(e[f].information);return a.reject(new FifthweekError("No shared access signatures found for container: "+d))}return a.when(b.publicSignature)})},d.getContainerAccessMap=function(){return b.getSignatures().then(function(b){var c={};return c[b.publicSignature.containerName]=b.publicSignature,c=_.reduce(b.privateSignatures,function(a,b){return a[b.information.containerName]=b.information,a},c),a.when(c)})},d}]),angular.module("webApp").constant("accessSignaturesCacheConstants",{refreshMinimumExpiry:6e5,failMinimumExpiry:3e4}).factory("accessSignaturesCache",["accessSignaturesCacheImpl",function(a){"use strict";return a.initialize(),a}]).factory("accessSignaturesCacheImpl",["$rootScope","$q","userAccessSignaturesStub","authenticationService","accessSignaturesCacheConstants","fetchAggregateUserStateConstants",function(a,b,c,d,e,f){"use strict";var g={},h={lastResult:void 0,currentQuery:void 0,nextId:0},i=function(a,b){var c=new Date,d=c.getTime()+1e3*b.timeToLiveSeconds;h.lastResult={expires:d,userId:a,data:b}},j=function(a){if(h.currentQuery&&h.currentQuery.userId===a)return h.currentQuery.promise;var d=h.nextId++;h.currentQuery={userId:a,id:d,promise:void 0};var f;return f=a?c.getForUser(a):c.getForVisitor(),f=f.then(function(c){return h.currentQuery&&h.currentQuery.id===d&&(h.currentQuery=void 0,i(a,c.data)),b.when(c.data)},function(a){return h.currentQuery&&h.currentQuery.id===d&&(h.currentQuery=void 0),k(e.failMinimumExpiry)?b.reject(a):b.when(h.lastResult.data)}),h.currentQuery.promise=f,f},k=function(a){if(!h.lastResult)return!0;var b=new Date;return h.lastResult.expires-b.getTime()<a?!0:!1},l=function(a){return k(e.refreshMinimumExpiry)?!0:h.lastResult.userId!==a?!0:!1},m=function(a,b,c){i(b,c.accessSignatures)};return g.getSignatures=function(){var a=d.currentUser.userId;return l(a)?j(a):b.when(h.lastResult.data)},g.initialize=function(){a.$on(f.fetchedEvent,m)},g}]),angular.module("webApp").factory("authenticationInterceptor",["$q","$injector","states","fifthweekConstants",function(a,b,c,d){"use strict";var e,f,g,h={};h.currentTokenRequest=void 0;var i=function(a){return(e=e||b.get("$http"))(a)},j=function(){return h.currentTokenRequest||(h.currentTokenRequest=g.refreshToken(),h.currentTokenRequest["catch"](function(){f=f||b.get("$state"),f.go(c.signIn.name)})["finally"](function(){h.currentTokenRequest=void 0})),h.currentTokenRequest};return h.request=function(a){return a.headers=a.headers||{},g=g||b.get("authenticationService"),g.currentUser.authenticated&&_.startsWith(a.url,d.apiBaseUri)&&(a.headers.Authorization="Bearer "+g.currentUser.accessToken),a},h.responseError=function(c){return 401!==c.status||c.config.hasRetried?a.reject(c):(c.config.hasRetried=!0,g=g||b.get("authenticationService"),j().then(function(){return i(c.config)},function(){return a.reject(c)}))},h}]),angular.module("webApp").constant("authenticationServiceConstants",{currentUserChangedEvent:"currentUserChanged",roles:{creator:"creator",administrator:"administrator",preRelease:"pre-release"}}).factory("authenticationService",["authenticationServiceImpl",function(a){"use strict";return a.initialize(),a}]).factory("authenticationServiceImpl",["$http","$q","$rootScope","analytics","localStorageService","fetchAggregateUserState","fifthweekConstants","authenticationServiceConstants","utilities",function(a,b,c,d,e,f,g,h,i){"use strict";var j=g.apiBaseUri,k={},l="currentUser";k.currentUser={};var m=function(){c.$broadcast(h.currentUserChangedEvent,k.currentUser)},n=function(){k.currentUser.authenticated=!1,k.currentUser.accessToken=void 0,k.currentUser.refreshToken=void 0,k.currentUser.userId=void 0,k.currentUser.roles=void 0,e.remove(l),m()},o=function(a,b,c,d){k.currentUser.authenticated=!0,k.currentUser.accessToken=a,k.currentUser.refreshToken=b,k.currentUser.userId=c,k.currentUser.roles=d,e.set(l,k.currentUser),m()},p=function(a){return b(function(b,c){var d=[],e=a.data.roles;e&&(d=a.data.roles.split(","));var f=a.data.user_id;if(!f)return c(new FifthweekError("The user ID was not returned"));var g=a.data.access_token;if(!g)return c(new FifthweekError("The access token was not returned"));var h=a.data.refresh_token;return h?(o(g,h,f,d),b()):c(new FifthweekError("The refresh token was not returned"))})};return k.initialize=function(){var a=e.get(l);a?(k.currentUser=a,m()):n()},k.registerUser=function(c){return k.currentUser.authenticated?b.reject(new FifthweekError("You must sign out before registering.")):a.post(j+"membership/registrations",c)["catch"](function(a){return b.reject(i.getHttpError(a))})},k.signIn=function(c){if(k.currentUser.authenticated)return b.reject(new FifthweekError("You must sign out before signing in."));var e="grant_type=password&username="+c.username+"&password="+c.password+"&client_id="+g.clientId,h={headers:{"Content-Type":"application/x-www-form-urlencoded"}};return a.post(j+"token",e,h)["catch"](function(a){return b.reject(i.getHttpError(a))}).then(function(a){return p(a)}).then(function(){d.setUsername(k.currentUser.userId)}).then(function(){return f.updateFromServer(k.currentUser.userId)})["catch"](function(a){return k.signOut(),b.reject(a)})},k.refreshToken=function(){if(!k.currentUser.authenticated)return b.reject(new FifthweekError("Cannot refresh the authentication token because the user is not authenticated."));var c="grant_type=refresh_token&refresh_token="+k.currentUser.refreshToken+"&client_id="+g.clientId;return a.post(j+"token",c,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return p(a)},function(a){return b.reject(i.getHttpError(a))})["catch"](function(a){return k.signOut(),b.reject(a)})},k.signOut=function(){return n(),f.updateFromServer()},k}]),angular.module("webApp").constant("authorizationServiceConstants",{authorizationResult:{authorized:"authorized",loginRequired:"loginRequired",notAuthorized:"notAuthorized"},fwRoleCheckType:{atLeastOne:"atLeastOne",all:"all"}}).factory("authorizationService",["authenticationService","authorizationServiceConstants",function(a,b){"use strict";var c={};return c.authorize=function(c,d,e){var f=b.authorizationResult.authorized,g=!0;if(e=e||b.fwRoleCheckType.atLeastOne,c===!0&&a.currentUser.authenticated===!1)f=b.authorizationResult.loginRequired;else if(c!==!0||a.currentUser.authenticated===!1||void 0!==d&&0!==d.length){if(d){var h=[];angular.forEach(a.currentUser.roles,function(a){h.push(a.toLowerCase())});for(var i=0;i<d.length;i+=1){var j=d[i].toLowerCase();if(e===b.fwRoleCheckType.all){if(g=g&&h.indexOf(j)>-1,g===!1)break}else if(e===b.fwRoleCheckType.atLeastOne&&(g=h.indexOf(j)>-1))break}f=g?b.authorizationResult.authorized:b.authorizationResult.notAuthorized}}else f=b.authorizationResult.authorized;return f},c}]),angular.module("webApp").factory("calculatedStates",["$q","states","blogService","authenticationService","authenticationServiceConstants",function(a,b,c,d,e){"use strict";var f={};return f.getDefaultState=function(){var a=d.currentUser;return a.authenticated===!0?_.includes(a.roles,e.roles.creator)?c.hasBlog?b.dashboard.name:b.creators.createBlog.name:b.dashboard.name:b.home.name},f}]),angular.module("webApp").factory("domUtilities",function(){"use strict";var a={};return a.ancestor=function(b,c,d){if(isNaN(d))d=10;else if(d--<=0)return null;var e=c.parent();return e.prop("tagName")!==b?a.ancestor(b,e,d):e},a}),angular.module("webApp").factory("deleteVerification",["$modal",function(a){"use strict";var b={};return b.verifyDelete=function(b,c,d,e,f){var g=a.open({controller:"deleteVerificationCtrl",templateUrl:"views/partials/delete-verification.html",size:f?void 0:"sm",resolve:{deleteContext:function(){return{item:f,itemType:e,dataEventTitle:c,dataEventCategory:d,action:b}}}});return g.result},b}]),angular.module("webApp").factory("developerRequestInterceptor",["fifthweekConstants",function(a){"use strict";var b={};return b.request=function(b){return a.developerName&&(b.headers=b.headers||{},b.headers[a.developerNameHeader]=a.developerName),b},b}]),angular.module("webApp").factory("errorFacade",["$q","logService","utilities",function(a,b,c){"use strict";var d={};return d.handleError=function(d,e){return d instanceof CancellationError?a.when():(e(c.getFriendlyErrorMessage(d)),b.error(d))},d.handleErrorInBackground=function(d){return d instanceof CancellationError?a.when():(b.error(d),c.getFriendlyErrorMessage(d))},d}]),angular.module("webApp").factory("logService",["$injector","$log","$window","fifthweekConstants",function(a,b,c,d){"use strict";var e={},f=d.apiBaseUri+d.logPath;e.shouldLog=function(a){return void 0!==a&&!jQuery.isEmptyObject(a)};var g=function(d,g){if(e.shouldLog(g)){var h={level:d,payload:{url:c.location.href,message:g}},i=a.get("$http");return i.post(f,h)["catch"](function(a){b.warn("Server-side logging failed"),b.warn(a)})}};return e.debug=function(a){return b.debug(a),g("debug",a)},e.info=function(a){return b.info(a),g("info",a)},e.warn=function(a){return b.warn(a),g("warn",a)},e.error=function(a){return a instanceof ApiError||a instanceof InputValidationError?void b.info(a.message):(b.error(a),g("error",a))},e.logUnhandledError=function(a,c){if(e.shouldLog(a)||e.shouldLog(c)){if(!(a instanceof ApiError)){var d={cause:c,exception:a};return g("error",d)}b.info(a.message)}},e}]),angular.module("webApp").constant("navigationOrchestratorConstants",{navigationChangedEvent:"navigationChanged"}).factory("navigationOrchestrator",["navigationOrchestratorImpl",function(a){"use strict";return a.initialize(),a}]).factory("navigationOrchestratorImpl",["$rootScope","navigationMap","stateChangeService","authenticationServiceConstants","aggregateUserStateConstants","navigationOrchestratorConstants","uiRouterConstants","$state",function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=[],l=[],m={},n=function(){a.$broadcast(f.navigationChangedEvent,k,l)},o=function(a){return"function"==typeof a?a():a},p=function(a){var b=!0;return void 0!==a.state?c.isPermitted(h.get(a.state)):b},q=function(a,b){var c=o(a.name),d="navigation-"+_.kebabCase(a.id||c);return{separator:a.separator,name:c,state:a.state,icon:a.icon,color:a.color,isActive:b,id:d}},r=function(a){if(void 0===a||0===a.length)return j=void 0,m.secondaryNavigation=[],[];for(var b=[],c=0;c<a.length;c++){var d=a[c];if(p(d)){var e=q(d,d===j);b.push(e)}}return b},s=function(){for(var a=[],c=[],d=0;d<b.length;d++){var e=b[d];if(p(e)){var f=q(e,e===i);f.separator?a.length>0&&!_.last(a).separator&&a.push(f):a.push(f),f.isActive&&(c=r(e.secondary))}}a.length>0&&_.last(a).separator&&a.pop(),k=a,l=c,n()},t=function(){for(var a=0;a<b.length;a++){var c=b[a],d=c.secondary;if(d)for(var e=0;e<d.length;e++){var f=d[e];if(h.includes(f.state))return i=c,void(j=f)}if(h.includes(c.state))return i=c,void(j=void 0)}i=void 0,j=void 0};return m.initialize=function(){a.$on(g.stateChangeSuccessEvent,function(){t(),s()}),a.$on(d.currentUserChangedEvent,function(){s()}),a.$on(e.updatedEvent,function(){s()}),t(),s()},m.getPrimaryNavigation=function(){return k},m.getSecondaryNavigation=function(){return l},m}]),angular.module("webApp").factory("stateChangeAuthorizationService",["authenticationService","authorizationService","authorizationServiceConstants","$state","states","calculatedStates",function(a,b,c,d,e,f){"use strict";var g,h,i={},j=!1,k=function(a){return b.authorize(a.data.access.requireAuthenticated,a.data.access.roles,a.data.access.fwRoleCheckType)};return i.isPermitted=function(b){return void 0!==b.data&&void 0!==b.data.access?b.data.access.requireUnauthenticated?a.currentUser.authenticated===!1:k(b)===c.authorizationResult.authorized:!0},i.redirectAwayIfRequired=function(b,i,l){if(j&&i.name!==e.signIn.name)j=!1,void 0!==i.data&&void 0!==i.data.access&&i.data.access.requireAuthenticated===!0&&(b.preventDefault(),d.go(g,h,{location:"replace"}));else if(void 0!==i.data&&void 0!==i.data.access)if(i.data.access.requireUnauthenticated)a.currentUser.authenticated===!0&&(b.preventDefault(),d.go(f.getDefaultState()));else{var m=k(i);m===c.authorizationResult.loginRequired?(j=!0,g=i.name,h=l,b.preventDefault(),d.go(e.signIn.name)):m===c.authorizationResult.notAuthorized&&(b.preventDefault(),d.go(e.notAuthorized.name))}},i}]),angular.module("webApp").factory("stateChangeRedirectionService",["$state",function(a){"use strict";var b={};return b.isPermitted=function(){return!0},b.redirectAwayIfRequired=function(b,c,d){c.redirectTo&&(b.preventDefault(),a.go(c.redirectTo,d))},b}]),angular.module("webApp").factory("stateChangeRequireBlogService",["$state","calculatedStates","blogService",function(a,b,c){"use strict";var d={};return d.isPermitted=function(a){return void 0!==a.requireBlog&&a.requireBlog!==c.hasBlog?!1:!0},d.redirectAwayIfRequired=function(c,e,f){d.isPermitted(e)||(c.preventDefault(),a.go(b.getDefaultState(),f))},d}]),angular.module("webApp").factory("stateChangeService",["stateChangeAuthorizationService","stateChangeRedirectionService","stateChangeRequireBlogService",function(a,b,c){"use strict";var d=[a,b,c],e={};return e.isPermitted=function(a){return _.every(d,function(b){return b.isPermitted(a)})},e.redirectAwayIfRequired=function(a,b,c){_.forEach(d,function(d){d.redirectAwayIfRequired(a,b,c)})},e}]),angular.module("webApp").factory("utilities",["fifthweekConstants","$parse",function(a,b){"use strict";var c={};return c.getAccessorPathSegments=function(a){return a=a.replace(/\[(\w+)\]/g,".$1"),a=a.replace(/^\./,""),a.split(".")},c.getValue=function(a,b){for(var d=_.isArray(b)?b:c.getAccessorPathSegments(b),e=0;e<d.length;++e){var f=d[e];if(!(f in a))return;a=a[f]}return a},c.getHttpError=function(b){if(0===b.status)return new ConnectionError(b);if(401===b.status)return new UnauthenticatedError("Not authenticated.");if(403===b.status)return new UnauthorizedError("Not authorized.");if(void 0!==b.data){if(void 0!==b.data.message)return new ApiError(b.data.message,b);if(void 0!==b.data.error_description)return new ApiError(b.data.error_description,b)}return new ApiError(a.unexpectedErrorText,b)},c.getFriendlyErrorMessage=function(b){return b instanceof DisplayableError?b.message:b instanceof ConnectionError?a.connectionErrorText:a.unexpectedErrorText},c.parseFlag=function(a,b){return a.hasOwnProperty(b)?a[b]!==!1:!1},c.forScope=function(a){var c={};return c.getAccessor=function(c){var d=c.lastIndexOf(".");if(-1===d)throw new FifthweekError("Must not be bound to primitive");var e=b(c.substring(0,d))(a),f=c.substring(d+1);return{root:e,accessor:f}},c},c.forDirective=function(a,d,e){var f={};return f.scaffoldFormInput=function(){a.showHelp=c.parseFlag(e,"showHelp"),a.required=c.parseFlag(e,"required"),a.focus=c.parseFlag(e,"focus"),a.placeholder=e.placeholder,a.breakpoint=e.breakpoint||"sm",a.label=e.label;var d=c.forScope(a);if(e.ngModel){a.inputId=e.inputId||e.ngModel.replace(/\./g,"-");var f=d.getAccessor(e.ngModel);a.ngModel=f.root,a.ngModelAccessor=f.accessor}var g=b(e.ngRequired);a.isRequired=function(){return e.ngRequired?g(a):a.required};var h=b(e.ngDisabled);a.isDisabled=function(){return e.ngDisabled?h(a):!1}},f},c}]),angular.module("webApp").factory("azureBlobUpload",["$q","logService","azureBlobStub",function(a,b,c){"use strict";var d=262144,e={},f=function(a,b){for(var c=""+a;c.length<b;)c="0"+c;return c},g=function(a,c,d){b.error({message:c,error:a}),d.deferred.reject(a)},h=function(a,c){try{a.progress(c)}catch(d){b.error({message:"Progress callback failed during blob upload.",error:d})}},i=function(b){var c=d;b.blockSize&&(c=b.blockSize);var e=c,f=1,g=b.file,h=g.size;return c>h&&(e=h),f=h%e===0?h/e:parseInt(h/e,10)+1,{maxBlockSize:e,numberOfBlocks:f,totalBytesRemaining:h,currentFilePointer:0,blockIds:[],bytesUploaded:0,submitUri:null,file:g,signature:b.signature,uri:b.uri+b.signature,progress:b.progress||function(){},azureCalled:b.azureCalled||function(){},deferred:a.defer()}},j=function(a,b){if(b.totalBytesRemaining>0){var c=b.file.slice(b.currentFilePointer,b.currentFilePointer+b.maxBlockSize),d=f(b.blockIds.length,8);b.blockIds.push(d),b.currentFilePointer+=b.maxBlockSize,b.totalBytesRemaining-=b.maxBlockSize,b.totalBytesRemaining<b.maxBlockSize&&(b.maxBlockSize=b.totalBytesRemaining),a.readAsArrayBuffer(c)}else k(b)},k=function(a){c.commitBlockList(a.uri,a.blockIds,a.file.type).then(function(){a.deferred.resolve()})["catch"](function(b){g(b,"Failed to commit blob list.",a)}),a.azureCalled()},l=function(a,b,d){try{if(a.target.readyState===FileReader.DONE){var e=new Uint8Array(a.target.result);c.putBlockBlob(b.uri,b.blockIds[b.blockIds.length-1],e).then(function(){b.bytesUploaded+=e.length;var a=(parseFloat(b.bytesUploaded)/parseFloat(b.file.size)*100).toFixed(2);h(b,a),j(d,b)})["catch"](function(a){g(a,"Failed to upload block blob.",b)}),b.azureCalled()}}catch(f){g(f,"Failed to upload block blob.",b)}};return e.upload=function(a){var b=i(a);try{var c=new FileReader;c.onloadend=function(a){return l(a,b,c)},j(c,b)}catch(d){g(d,"Failed to initiate file upload.",b)}return b.deferred.promise},e}]),angular.module("webApp").factory("blobImageControlFactory",["$q",function(a){"use strict";var b={};return b.createControl=function(){var b={deferred:a.defer(),updateHandler:void 0},c={update:function(a,c,d){return b.deferred.promise.then(function(){return b.updateHandler(a,c,d)})},initialize:function(a){b.updateHandler=a,b.deferred.resolve()}};return c},b}]),angular.module("webApp").factory("wrapUserAction",["$q","errorFacade","analytics",function(a,b,c){"use strict";return function(d,e){var f;try{f=a.when(d())}catch(g){f=a.reject(g)}return f.then(function(){if(e){var a=e.eventTitle,b=e.eventCategory;return a&&b?c.eventTrack(a,b).then(function(){}):void 0}},function(a){return b.handleErrorInBackground(a)})}}]),angular.module("webApp").factory("availabilityStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.get=function(){return a.get(e+"availability")["catch"](function(a){return b.reject(d.getHttpError(a))})},f.head=function(){return a.get(e+"availability")["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("channelStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.postChannel=function(c){return a.post(e+"channels",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putChannel=function(c,f){return a.put(e+"channels/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.deleteChannel=function(c){return a["delete"](e+"channels/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("collectionStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.postCollection=function(c){return a.post(e+"collections",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putCollection=function(c,f){return a.put(e+"collections/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.deleteCollection=function(c){return a["delete"](e+"collections/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getLiveDateOfNewQueuedPost=function(c){return a.get(e+"collections/"+encodeURIComponent(c)+"/newQueuedPostLiveDate")["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("endToEndTestInboxStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.getLatestMessageAndClearMailbox=function(c){return a.get(e+"testMailboxes/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("accountSettingsStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.get=function(c){return a.get(e+"accountSettings/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.put=function(c,f){return a.put(e+"accountSettings/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("membershipStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.postRegistration=function(c){return a.post(e+"membership/registrations",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getUsernameAvailability=function(c){return a.get(e+"membership/availableUsernames/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postPasswordResetRequest=function(c){return a.post(e+"membership/passwordResetRequests",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postPasswordResetConfirmation=function(c){return a.post(e+"membership/passwordResetConfirmations",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getPasswordResetTokenValidity=function(c,f){return a.get(e+"membership/passwordResetTokens/"+encodeURIComponent(c)+"?token="+encodeURIComponent(f))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("logStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.post=function(c){return a.post(e+"log",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("postsStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.getCreatorBacklog=function(c){return a.get(e+"posts/creatorBacklog/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getCreatorNewsfeed=function(c,f,g){return a.get(e+"posts/creatorNewsfeed/"+encodeURIComponent(c)+"?startIndex="+encodeURIComponent(f)+"&count="+encodeURIComponent(g))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.deletePost=function(c){return a["delete"](e+"posts/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postNewQueueOrder=function(c,f){return a.post(e+"posts/queues/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postToQueue=function(c){return a.post(e+"posts/queued",JSON.stringify(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postToLive=function(c){return a.post(e+"posts/live",JSON.stringify(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putLiveDate=function(c,f){return a.put(e+"posts/"+encodeURIComponent(c)+"/liveDate",f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postNote=function(c){return a.post(e+"posts/notes",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putNote=function(c,f){return a.put(e+"posts/notes/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postImage=function(c){return a.post(e+"posts/images",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putImage=function(c,f){return a.put(e+"posts/images/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postFile=function(c){return a.post(e+"posts/files",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putFile=function(c,f){return a.put(e+"posts/files/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("blogStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.postBlog=function(c){return a.post(e+"blogs",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.putBlog=function(c,f){return a.put(e+"blogs/"+encodeURIComponent(c),f)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getBlog=function(c){return a.get(e+"blogs/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("userAccessSignaturesStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.getForVisitor=function(){return a.get(e+"userAccessSignatures")["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getForUser=function(c){return a.get(e+"userAccessSignatures/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("fileUploadStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.postUploadRequest=function(c){return a.post(e+"files/uploadRequests",c)["catch"](function(a){return b.reject(d.getHttpError(a))})},f.postUploadCompleteNotification=function(c){return a.post(e+"files/uploadCompleteNotifications/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("userStateStub",["$http","$q","fifthweekConstants","utilities",function(a,b,c,d){"use strict";var e=c.apiBaseUri,f={};return f.getUserState=function(c){return a.get(e+"userState/"+encodeURIComponent(c))["catch"](function(a){return b.reject(d.getHttpError(a))})},f.getVisitorState=function(){return a.get(e+"userState")["catch"](function(a){return b.reject(d.getHttpError(a))})},f}]),angular.module("webApp").factory("azureBlobStub",["$http","$q",function(a,b){"use strict";var c={};return c.putBlockBlob=function(c,d,e){var f=c+"&comp=block&blockid="+d,g={headers:{"x-ms-blob-type":"BlockBlob"},transformRequest:[]};return a.put(f,e,g)["catch"](function(a){return b.reject(new AzureError("Failed to upload block blob.",a))})},c.commitBlockList=function(c,d,e){for(var f=c+"&comp=blocklist",g='<?xml version="1.0" encoding="utf-8"?><BlockList>',h=0;h<d.length;h++)g+="<Latest>"+d[h]+"</Latest>";g+="</BlockList>";var i={headers:{"x-ms-blob-content-type":e}};return a.put(f,g,i)["catch"](function(a){return b.reject(new AzureError("Failed to commit blob list.",a))})},c.tryGetAvailableBlobInformation=function(c){return a.head(c).then(function(a){var d={uri:c},e=a.headers(),f=e["x-ms-meta-width"],g=e["x-ms-meta-height"];return f&&g&&(d.width=f,d.height=g),b.when(d)})["catch"](function(a){return 404===a.status?b.when(void 0):b.reject(new AzureError("Failed to check blob availability.",a))})},c}]),function(a){"use strict";a.module("angulartics.kissmetrics",["angulartics"]).config(["$analyticsProvider",function(a){window._kmq="undefined"==typeof _kmq?[]:_kmq,a.registerPageTrack(function(a){window._kmq.push(["record",'Viewed page "'+a+'"'])}),a.registerEventTrack(function(a,b){window._kmq.push(["record",a,b])}),a.registerSetUsername(function(a){window._kmq.push(["identify",a])}),a.registerSetUserProperties(function(a){window._kmq.push(["set",a])})}])}(angular),function(a){"use strict";a.module("angulartics.google.analytics.userid",["angulartics"]).config(["$analyticsProvider",function(a){a.registerSetUsername(function(a){ga("set","&uid",a)})}])}(angular),angular.module("webApp").factory("analytics",["$q","$analytics","logService",function(a,b,c){"use strict";var d={};return d.eventTrack=function(d,e){try{return a.when(b.eventTrack(d,{category:e}))["catch"](function(a){c.error(a)})}catch(f){return c.error(f),a.when()}},d.setUsername=function(d){try{return a.when(b.setUsername(d))["catch"](function(a){c.error(a)})}catch(e){return c.error(e),a.when()}},d}]),angular.module("webApp").run(["$analytics",function(a){"use strict";function b(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}var c=function(){return{category:"Provenance"}},d=b("emailed_to");d.length>0&&a.setUserProperties({"last opened email from":d});var e=b("utm_campaign"),f=b("utm_source"),g=b("utm_medium"),h=b("utm_content");(e.length>0||f.length>0||g.length>0||h.length>0)&&a.eventTrack('Arrived from campaign "'+e+"/"+f+"/"+g+"/"+h+'"',c())}]);